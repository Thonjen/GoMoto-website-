import{r as d,f,o as m,d as C,i as h,u as F,b as l,t as x,N as V,O as S,_ as q,c as D,a as j,w as E,e as I,Q as z}from"./app-D5PUyAMe.js";import{_ as M}from"./OwnerLayout-R8EC1rpz.js";import{v as A,p as O,a as X,b as K,c as H,d as J}from"./filepond-plugin-file-validate-size.esm-DLcP4GBn.js";import{T as L}from"./trash-2-C3Tr9Ms7.js";import"./ResponsiveNavLink-BCB-x7oE.js";import"./Footer-DI0umZVU.js";import"./Header-DdPT2WJT.js";import"./createLucideIcon-B4NPXSPX.js";const W={class:"my-4"},Y={key:0,class:"mt-2 text-gray-700"},Z={class:"w-full bg-gray-200 rounded h-2 mt-1"},ee={key:1,class:"mt-2"},te=["src"],ae={key:2,class:"mt-2 text-red-600"},le={__name:"FilepondUploaderGcash",props:{maxFiles:{type:Number,default:5},acceptedFileTypes:{type:Array,default:()=>["image/jpeg","image/png"]},uploadUrl:{type:String,required:!0},existingFileUrl:{type:String,default:""},labelIdle:{type:String,default:"Drag & Drop your file or <span class='filepond--label-action'>Browse</span>"}},emits:["upload-success"],setup(r,{expose:v,emit:o}){var _;const u=(_=document.querySelector('meta[name="csrf-token"]'))==null?void 0:_.getAttribute("content"),c=r,U=o,b=A(J,H,K,X,O),g=d(null),t=d([]),e=d(!1),a=d(0),i=d(""),T={process:(n,p,y,w,B,G,N)=>{e.value=!0,a.value=0,i.value="";const Q=new FormData;return Q.append("gcash_qr",p),S.post(c.uploadUrl,Q,{headers:{"Content-Type":"multipart/form-data",...u?{"X-CSRF-TOKEN":u}:{}},withCredentials:!0,onUploadProgress:s=>{s.lengthComputable&&(a.value=Math.round(s.loaded*100/s.total),G(!0,s.loaded,s.total))}}).then(s=>{e.value=!1,a.value=100,U("upload-success",s.data),w(s.data.gcashQrUrl||"success")}).catch(s=>{var k,R;e.value=!1,a.value=0,i.value=((R=(k=s.response)==null?void 0:k.data)==null?void 0:R.message)||"Upload failed",B(i.value)}),{abort:()=>{e.value=!1,i.value="Upload aborted",N()}}},revert:(n,p,y)=>{S.delete(c.uploadUrl,{headers:{...u?{"X-CSRF-TOKEN":u}:{},"X-Inertia":!1},withCredentials:!0}).then(()=>{p()}).catch(w=>{y("Failed to delete file")})}};function P(n){t.value=n}function $(){var n;(n=g.value)==null||n.removeFiles()}return v({clearFiles:$}),(n,p)=>(m(),f("div",W,[C(F(b),{ref_key:"pond",ref:g,modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=y=>t.value=y),"label-idle":r.labelIdle,"accepted-file-types":r.acceptedFileTypes,"allow-multiple":r.maxFiles>1,"max-files":r.maxFiles,"instant-upload":!0,"image-resize-target-width":800,"image-resize-mode":"contain","image-transform-output-quality":.5,"image-transform-output-mime-type":"image/jpeg","max-file-size":"2MB",onUpdatefiles:P,server:T},null,8,["modelValue","label-idle","accepted-file-types","allow-multiple","max-files"]),e.value?(m(),f("div",Y,[l("span",null,"Uploading: "+x(a.value)+"%",1),l("div",Z,[l("div",{class:"bg-blue-600 h-2 rounded",style:V({width:a.value+"%"})},null,4)])])):h("",!0),r.existingFileUrl&&!t.value.length?(m(),f("div",ee,[l("img",{src:r.existingFileUrl,alt:"Existing file",class:"w-32 h-32 object-contain border rounded mx-auto"},null,8,te)])):h("",!0),i.value?(m(),f("div",ae,[l("span",null,"Error: "+x(i.value),1)])):h("",!0)]))}},oe={class:"md:col-span-3 bg-white p-6 rounded-lg shadow-md"},se={key:0,class:"mb-8 text-center"},re=["src"],ie={class:"text-sm text-gray-600 mt-2"},de={class:"text-2xl font-semibold text-gray-800 mb-4"},ne={__name:"UploadGcashQr",props:{gcashQrUrl:String,gcashQrUploadDate:String},setup(r){const v=r,o=d({imageUrl:v.gcashQrUrl,uploadDate:v.gcashQrUploadDate}),u=route("owner.gcash-qr.store"),c=d(null);function U({gcashQrUrl:t,gcashQrUploadDate:e}){var a,i;o.value.imageUrl=t,o.value.uploadDate=e,(i=(a=c.value)==null?void 0:a.clearFiles)==null||i.call(a)}function b(){confirm("Are you sure you want to remove your GCash QR code?")&&z.delete(route("owner.gcash-qr.destroy"),{onSuccess:t=>{var e,a;o.value.imageUrl="",o.value.uploadDate="",(a=(e=c.value)==null?void 0:e.clearFiles)==null||a.call(e)},onError:()=>{alert("Failed to remove QR code.")}})}const g=d([{id:1,date:"2025-07-15",description:"Booking for Toyota Camry (John Doe)",amount:4500,type:"credit",status:"Completed"},{id:2,date:"2025-07-10",description:"Payout to GCash",amount:1e4,type:"debit",status:"Completed"},{id:3,date:"2025-07-05",description:"Booking for Honda CRV (Maria Santos)",amount:6e3,type:"credit",status:"Completed"},{id:4,date:"2025-07-01",description:"Booking for Ford Ranger (Pending Payout)",amount:5e3,type:"credit",status:"Pending"}]);return D(()=>g.value.filter(t=>t.type==="credit"&&t.status==="Completed").reduce((t,e)=>t+e.amount,0)),D(()=>g.value.filter(t=>t.type==="credit"&&t.status==="Pending").reduce((t,e)=>t+e.amount,0)),(t,e)=>(m(),j(M,null,{default:E(()=>[l("div",oe,[e[2]||(e[2]=l("h1",{class:"text-3xl font-bold text-gray-800 mb-6"},"Upload GCash QR Code",-1)),e[3]||(e[3]=l("p",{class:"text-gray-700 mb-6"},"Upload your static GCash QR code image here. This will allow renters to easily pay you for bookings.",-1)),o.value.imageUrl?(m(),f("div",se,[e[1]||(e[1]=l("h2",{class:"text-2xl font-semibold text-gray-800 mb-4"},"Current GCash QR Code",-1)),l("img",{src:o.value.imageUrl,alt:"GCash QR Code",class:"w-64 h-64 object-contain mx-auto border border-gray-200 rounded-md p-2"},null,8,re),l("p",ie,"Uploaded on: "+x(o.value.uploadDate),1),l("button",{onClick:b,class:"mt-6 bg-red-500 text-white px-6 py-3 rounded-md font-semibold hover:bg-red-600 transition-colors flex items-center justify-center gap-2 mx-auto"},[C(F(L),{class:"h-5 w-5"}),e[0]||(e[0]=I(" Remove QR Code "))])])):h("",!0),l("h2",de,x(o.value.imageUrl?"Update QR Code":"Upload QR Code"),1),C(le,{ref_key:"filePondUploader",ref:c,maxFiles:1,acceptedFileTypes:["image/png","image/jpeg"],uploadUrl:F(u),existingFileUrl:o.value.imageUrl,onUploadSuccess:U},null,8,["uploadUrl","existingFileUrl"])])]),_:1}))}},he=q(ne,[["__scopeId","data-v-26bc9154"]]);export{he as default};
