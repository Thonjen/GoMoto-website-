import{j as J,r as V,a as K,o,w as y,b as e,f as a,i as d,d as z,u as F,S as N,e as u,F as W,h as X,t as r,n as k,l as Z,Q as f}from"./app-D5PUyAMe.js";import{_ as I}from"./OwnerLayout-R8EC1rpz.js";import"./ResponsiveNavLink-BCB-x7oE.js";import"./Footer-DI0umZVU.js";import"./Header-DdPT2WJT.js";const ee={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},te={class:"p-6 text-gray-900"},se={class:"mb-6 flex justify-between items-center"},ne={class:"flex bg-gray-100 rounded-lg p-1"},re={key:0,class:"text-center py-12"},ie={key:1,class:"space-y-6"},oe={class:"p-6"},ae={class:"flex items-start justify-between"},le={class:"flex space-x-4"},de=["src","alt"],ue={class:"flex-1"},ce={class:"text-lg font-semibold text-gray-900"},me={class:"text-sm text-gray-500 mb-2"},fe={class:"grid grid-cols-2 gap-4 text-sm text-gray-600"},pe={class:"mt-3 flex items-center space-x-4 text-sm text-gray-600"},xe={key:0},ye=["href"],he={class:"flex flex-col items-end space-y-3"},ve={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},_e={key:2,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},ge={key:0,class:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},we={class:"flex items-start space-x-3"},be=["src","onClick"],Ce={class:"mt-4 flex justify-end space-x-3"},Pe=["onClick"],Me={key:0,class:"flex space-x-2"},Be=["onClick","disabled"],je=["onClick","disabled"],De=["onClick","disabled"],Re=["onClick","disabled"],$e={class:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-auto"},Se={class:"p-4 text-center"},Ve=["src"],Le={__name:"Index",props:{bookings:Array},setup(h){const i=J({}),p=V(!1),x=V("");function A(s){return{pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[s]||"bg-gray-100 text-gray-800"}function L(s){return s?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}function H(s){return{pending:"Pending",confirmed:"Confirmed",completed:"Completed",cancelled:"Cancelled"}[s]||s}function q(s){return new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}function O(s){x.value=s,p.value=!0}function v(){p.value=!1,x.value=""}function Q(s){f.visit(route("owner.bookings.show",s))}function T(s){i[s]=!0,f.post(route("owner.bookings.confirmPayment",s),{},{onFinish:()=>{i[s]=!1}})}function U(s){i[s]=!0,f.post(route("owner.bookings.confirm",s),{},{onFinish:()=>{i[s]=!1}})}function E(s){confirm("Are you sure you want to reject this booking?")&&(i[s]=!0,f.post(route("owner.bookings.reject",s),{},{onFinish:()=>{i[s]=!1}}))}function Y(s){i[s]=!0,f.post(route("owner.bookings.complete",s),{},{onFinish:()=>{i[s]=!1}})}function G(s){if(s.status!=="confirmed"||s.return_time)return!1;const n=new Date,t=new Date(s.pickup_datetime),c=s.pricing_tier;let l=new Date(t);switch(c.duration_unit){case"minutes":l.setMinutes(l.getMinutes()+c.duration_from);break;case"hours":l.setHours(l.getHours()+c.duration_from);break;case"days":l.setDate(l.getDate()+c.duration_from);break;default:l.setDate(l.getDate()+1)}return s.is_extended&&s.extended_until&&(l=new Date(s.extended_until)),n>l}return(s,n)=>(o(),K(I,null,{default:y(()=>[e("div",ee,[e("div",te,[e("div",se,[n[2]||(n[2]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-800"}," Booking Requests "),e("p",{class:"text-gray-600 mt-2"}," Manage bookings for your vehicles ")],-1)),e("div",ne,[z(F(N),{href:s.route("owner.bookings.index"),class:"px-3 py-2 rounded-md text-sm font-medium transition-all bg-white shadow"},{default:y(()=>n[0]||(n[0]=[u(" List View ")])),_:1,__:[0]},8,["href"]),z(F(N),{href:s.route("owner.bookings.calendar"),class:"px-3 py-2 rounded-md text-sm font-medium transition-all hover:bg-white hover:shadow"},{default:y(()=>n[1]||(n[1]=[u(" Calendar View ")])),_:1,__:[1]},8,["href"])])]),h.bookings.length===0?(o(),a("div",re,n[3]||(n[3]=[e("div",{class:"mb-4"},[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1),e("h3",{class:"text-lg font-medium text-gray-900"}," No booking requests ",-1),e("p",{class:"mt-2 text-sm text-gray-500"}," You don't have any booking requests yet. ",-1)]))):(o(),a("div",ie,[(o(!0),a(W,null,X(h.bookings,t=>{var c,l,_,g,w,b,C,P,M,B,j,D,R,$,S;return o(),a("div",{key:t.id,class:"border rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-200"},[e("div",oe,[e("div",ae,[e("div",le,[e("img",{src:t.vehicle.main_photo_url||"/images/placeholder-vehicle.jpg",alt:`${(c=t.vehicle.brand)==null?void 0:c.name} ${(l=t.vehicle.type)==null?void 0:l.sub_type}`,class:"w-20 h-20 object-cover rounded-lg"},null,8,de),e("div",ue,[e("h3",ce,r((_=t.vehicle.brand)==null?void 0:_.name)+" "+r((g=t.vehicle.type)==null?void 0:g.sub_type),1),e("p",me," Booking #"+r(t.id)+" by "+r(t.user.first_name)+" "+r(t.user.last_name),1),e("div",fe,[e("div",null,[n[4]||(n[4]=e("span",{class:"font-medium"},"Duration:",-1)),u(" "+r((w=t.pricing_tier)==null?void 0:w.duration_from)+" "+r(((b=t.pricing_tier)==null?void 0:b.duration_from)===1?(P=(C=t.pricing_tier)==null?void 0:C.duration_unit)==null?void 0:P.slice(0,-1):(M=t.pricing_tier)==null?void 0:M.duration_unit),1)]),e("div",null,[n[5]||(n[5]=e("span",{class:"font-medium"},"Amount:",-1)),u(" ₱"+r(t.total_amount),1)]),e("div",null,[n[6]||(n[6]=e("span",{class:"font-medium"},"Pickup:",-1)),u(" "+r(q(t.pickup_datetime)),1)]),e("div",null,[n[7]||(n[7]=e("span",{class:"font-medium"},"Payment:",-1)),u(" "+r(((j=(B=t.payment)==null?void 0:B.payment_mode)==null?void 0:j.name)||"N/A"),1)])]),e("div",pe,[e("div",null,[n[8]||(n[8]=e("span",{class:"font-medium"},"Customer:",-1)),u(" "+r(t.user.email),1)]),t.user.phone?(o(),a("div",xe,[n[9]||(n[9]=e("span",{class:"font-medium"},"Phone:",-1)),e("a",{href:`tel:${t.user.phone}`,class:"text-blue-600 hover:text-blue-800"},r(t.user.phone),9,ye)])):d("",!0)])])]),e("div",he,[e("span",{class:k([A(t.status),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},r(H(t.status)),3),t.payment?(o(),a("span",{key:0,class:k([L(t.payment.paid_at),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},r(t.payment.paid_at?"Payment Confirmed":"Payment Pending"),3)):d("",!0),t.status==="confirmed"&&G(t)?(o(),a("div",ve,n[10]||(n[10]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),u(" ⚠️ Potential Overcharges ")]))):t.status==="confirmed"?(o(),a("div",_e,n[11]||(n[11]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),u(" 🟢 Active Rental ")]))):d("",!0)])]),(D=t.payment)!=null&&D.receipt_image&&!t.payment.paid_at?(o(),a("div",ge,[n[13]||(n[13]=e("h4",{class:"text-sm font-medium text-yellow-800 mb-2"}," Payment Proof Submitted ",-1)),e("div",we,[e("img",{src:t.payment.receipt_image,alt:"Payment Receipt",class:"w-20 h-20 object-cover rounded border cursor-pointer",onClick:m=>O(t.payment.receipt_image)},null,8,be),n[12]||(n[12]=e("p",{class:"text-sm text-yellow-700"}," Customer uploaded payment proof. Please verify and confirm the payment. ",-1))])])):d("",!0),e("div",Ce,[e("button",{onClick:m=>Q(t.id),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," View Details ",8,Pe),t.status==="pending"?(o(),a("div",Me,[(R=t.payment)!=null&&R.receipt_image&&!t.payment.paid_at?(o(),a("button",{key:0,onClick:m=>T(t.id),disabled:i[t.id],class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"},r(i[t.id]?"Processing...":"Confirm Payment"),9,Be)):d("",!0),(($=t.payment)==null?void 0:$.type)==="cod"||(S=t.payment)!=null&&S.paid_at?(o(),a("button",{key:1,onClick:m=>U(t.id),disabled:i[t.id],class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},r(i[t.id]?"Processing...":"Confirm Booking"),9,je)):d("",!0),e("button",{onClick:m=>E(t.id),disabled:i[t.id],class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},r(i[t.id]?"Processing...":"Reject"),9,De)])):d("",!0),t.status==="confirmed"?(o(),a("button",{key:1,onClick:m=>Y(t.id),disabled:i[t.id],class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50"},r(i[t.id]?"Processing...":"Mark Complete"),9,Re)):d("",!0)])])])}),128))]))])]),p.value?(o(),a("div",{key:0,onClick:Z(v,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},[e("div",$e,[e("div",{class:"p-4 border-b flex justify-between items-center"},[n[15]||(n[15]=e("h3",{class:"text-lg font-semibold"},"Payment Receipt",-1)),e("button",{onClick:v,class:"text-gray-400 hover:text-gray-600"},n[14]||(n[14]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Se,[e("img",{src:x.value,alt:"Payment Receipt",class:"max-w-full h-auto mx-auto rounded border"},null,8,Ve)])])])):d("",!0)]),_:1}))}};export{Le as default};
