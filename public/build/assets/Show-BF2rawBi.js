import{f as u,o as d,b as e,t as s,i as x,e as V,n as j,c as w,F as L,h as N,g as U,k as K,v as q,I as X,_ as G,r as R,a as z,w as Z,d as T,l as E,Q as O}from"./app-Bp2smfCm.js";import{A as ee}from"./AuthenticatedLayout-CeqprHFF.js";import{S as p}from"./sweetalert2.esm.all-ePrzfkxH.js";import"./Footer-BrurEhWM.js";import"./Header-fek8bTNe.js";const te={class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},oe={class:"flex items-start space-x-4"},ne={class:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-xl font-semibold"},se={class:"flex-1"},ie={class:"text-lg font-semibold text-white"},re={class:"space-y-1 text-sm text-white/70"},ae={__name:"CustomerInformation",props:{booking:Object},setup(t){return(r,i)=>(d(),u("div",te,[i[0]||(i[0]=e("h2",{class:"text-xl font-semibold mb-4 text-white"}," Customer Information ",-1)),e("div",oe,[e("div",ne,s(t.booking.user.first_name.charAt(0))+s(t.booking.user.last_name.charAt(0)),1),e("div",se,[e("h3",ie,s(t.booking.user.first_name)+" "+s(t.booking.user.last_name),1),e("div",re,[e("div",null,s(t.booking.user.email),1),e("div",null,s(t.booking.user.phone),1)])])])]))}},le={class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},de={class:"flex items-center justify-between mb-4"},ce={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue={key:0,class:"text-center"},ge={class:"bg-white/10 p-4 rounded-lg border border-white/20"},me=["src"],be={key:1,class:"text-center"},he={class:"bg-white/10 p-4 rounded-lg border border-white/20"},fe=["src"],ve={key:1,class:"text-center py-8"},xe={key:2,class:"mt-4 p-3 bg-yellow-500/20 border border-yellow-500/30 rounded-lg"},ke={class:"flex items-start space-x-2"},ye={class:"text-sm text-yellow-200"},pe={__name:"DriversLicenseVerification",props:{booking:Object},emits:["open-license-modal"],setup(t){return(r,i)=>(d(),u("div",le,[e("div",de,[i[2]||(i[2]=e("h2",{class:"text-xl font-semibold text-white flex items-center"},[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),V(" Driver's License Verification ")],-1)),e("span",{class:j([t.booking.user.kyc_status==="approved"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800","inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"])},s(t.booking.user.kyc_status==="approved"?"‚úì Verified":"‚ö† "+t.booking.user.kyc_status),3)]),t.booking.user.drivers_license_front_url||t.booking.user.drivers_license_back_url?(d(),u("div",ce,[t.booking.user.drivers_license_front_url?(d(),u("div",ue,[i[3]||(i[3]=e("p",{class:"text-sm text-white/70 mb-3 font-medium"},"Front Side",-1)),e("div",ge,[e("img",{src:t.booking.user.drivers_license_front_url,alt:"Driver's License Front",class:"w-full h-48 object-cover rounded border border-gray-600/30 cursor-pointer hover:opacity-75 transition-opacity",onClick:i[0]||(i[0]=g=>r.$emit("open-license-modal","front",t.booking.user.drivers_license_front_url))},null,8,me)])])):x("",!0),t.booking.user.drivers_license_back_url?(d(),u("div",be,[i[4]||(i[4]=e("p",{class:"text-sm text-white/70 mb-3 font-medium"},"Back Side",-1)),e("div",he,[e("img",{src:t.booking.user.drivers_license_back_url,alt:"Driver's License Back",class:"w-full h-48 object-cover rounded border border-gray-600/30 cursor-pointer hover:opacity-75 transition-opacity",onClick:i[1]||(i[1]=g=>r.$emit("open-license-modal","back",t.booking.user.drivers_license_back_url))},null,8,fe)])])):x("",!0)])):(d(),u("div",ve,i[5]||(i[5]=[e("svg",{class:"w-12 h-12 text-white/30 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-white/60 font-medium"},"No driver's license uploaded",-1),e("p",{class:"text-sm text-white/40 mt-1"},"This renter has not completed Driver's License Verification",-1)]))),t.booking.user.kyc_status!=="approved"?(d(),u("div",xe,[e("div",ke,[i[6]||(i[6]=e("div",{class:"text-yellow-300"},"‚ö†Ô∏è",-1)),e("div",ye," This renter's identity verification is "+s(t.booking.user.kyc_status)+". Please verify their documents before confirming the booking. ",1)])])):x("",!0)]))}},we={class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},$e={class:"flex space-x-4"},Ce=["src","alt"],Oe={class:"flex-1"},Be={class:"text-lg font-semibold text-white"},_e={class:"space-y-1 text-sm text-white/70"},Te={class:"mt-6"},Me={class:"w-full h-56 bg-gray-200 rounded-lg overflow-hidden"},Re=["src"],je={key:1,class:"flex items-center justify-center h-full text-white/70"},Pe={__name:"VehicleInformation",props:{booking:Object},setup(t){return(r,i)=>(d(),u("div",we,[i[2]||(i[2]=e("h2",{class:"text-xl font-semibold mb-4 text-white"}," Vehicle Information ",-1)),e("div",$e,[e("img",{src:t.booking.vehicle.main_photo_url||"/images/placeholder-vehicle.jpg",alt:t.booking.vehicle.year+" "+t.booking.vehicle.make.name+" "+t.booking.vehicle.model.name,class:"w-32 h-32 object-cover rounded-lg"},null,8,Ce),e("div",Oe,[e("h3",Be,s(t.booking.vehicle.year)+" "+s(t.booking.vehicle.make.name)+" "+s(t.booking.vehicle.model.name),1),e("div",_e,[e("div",null,"Type: "+s(t.booking.vehicle.type.name),1),e("div",null,"Transmission: "+s(t.booking.vehicle.transmission.name),1),e("div",null,"Fuel: "+s(t.booking.vehicle.fuel_type.name),1)])])]),e("div",Te,[i[1]||(i[1]=e("h2",{class:"text-xl font-semibold mb-4"}," Location Map ",-1)),e("div",Me,[t.booking.vehicle.lat&&t.booking.vehicle.lng?(d(),u("iframe",{key:0,src:`https://maps.google.com/maps?q=${t.booking.vehicle.lat},${t.booking.vehicle.lng}&z=18&t=k&output=embed`,width:"100%",height:"224",style:{border:"0"},allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"},null,8,Re)):(d(),u("div",je,i[0]||(i[0]=[e("div",{class:"text-center"},[e("svg",{class:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]),e("p",null,"Location not available")],-1)])))])])]))}},Fe={class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},Ae={class:"grid grid-cols-2 gap-6"},Se={class:"font-semibold"},De={class:"text-xl font-bold text-green-600"},Le={class:"font-semibold text-sm"},Ne={class:"font-semibold"},Ve={class:"mt-6 pt-4 border-t border-gray-200"},Ue={key:0,class:"glass-card border border-white/20 rounded-lg p-4 bg-white/5 backdrop-blur-sm shadow-glow"},Ie={class:"space-y-3"},He={class:"flex justify-between items-start"},Ye={class:"font-medium text-red-300"},qe={class:"text-sm text-gray-300"},ze={class:"text-xs text-gray-400 mt-1"},Ee={class:"text-right"},Ge={class:"font-bold text-red-300"},Qe={class:"mt-4 bg-gray-800/60 backdrop-blur-sm border border-gray-600/30 rounded-lg p-4"},We={class:"grid grid-cols-2 gap-4 text-sm text-gray-300"},Je={class:"flex justify-between"},Ke={class:"font-semibold text-white"},Xe={class:"flex justify-between"},Ze={class:"font-semibold text-red-400"},et={class:"flex justify-between"},tt={class:"text-green-400"},ot={class:"flex justify-between"},nt={class:"text-orange-400"},st={class:"border-t border-gray-600/30 mt-3 pt-3"},it={class:"flex justify-between font-bold text-lg text-white"},rt={__name:"BookingDetails",props:{booking:Object,estimatedReturn:String},setup(t){const r=t,i=w(()=>r.booking.overcharges&&r.booking.overcharges.length>0),g=w(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.reduce((m,n)=>m+parseFloat(n.amount||0),0)),a=w(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.filter(m=>m.is_paid).reduce((m,n)=>m+parseFloat(n.amount||0),0)),k=w(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.filter(m=>!m.is_paid).reduce((m,n)=>m+parseFloat(n.amount||0),0)),$=w(()=>{const m=parseFloat(r.booking.total_amount||0),n=g.value;return m+n});function f(m){return m==null||isNaN(m)?"0.00":parseFloat(m).toFixed(2)}function l(m){return new Date(m).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function b(m){return{1:"‚è∞ Late Return",2:"üèôÔ∏è Out of City Use"}[m]||"Unknown Overcharge"}function y(m){return m.replace(/Late return by ([\d.]+) hours/g,(n,o)=>{const c=parseFloat(o);return`Late return by ${C(c)}`})}function C(m){if(!m||m<=0)return"0 minutes";if(m<1){const n=Math.round(m*60);return n===1?"1 minute":`${n} minutes`}else{const n=Math.floor(m),o=Math.round((m-n)*60),c=n===1?"1 hour":`${n} hours`;if(o>0){const B=o===1?"1 minute":`${o} minutes`;return`${c} ${B}`}else return c}}return(m,n)=>(d(),u("div",Fe,[n[10]||(n[10]=e("h2",{class:"text-xl font-semibold mb-4 text-white"}," Booking Details ",-1)),e("div",Ae,[e("div",null,[n[0]||(n[0]=e("span",{class:"text-sm text-white/70"},"Duration",-1)),e("div",Se,s(t.booking.pricing_tier.duration_from)+" "+s(t.booking.pricing_tier.duration_from===1?t.booking.pricing_tier.duration_unit.slice(0,-1):t.booking.pricing_tier.duration_unit),1)]),e("div",null,[n[1]||(n[1]=e("span",{class:"text-sm text-white/70"},"Base Rental Fee",-1)),e("div",De," ‚Ç±"+s(f(t.booking.total_amount)),1)]),e("div",null,[n[2]||(n[2]=e("span",{class:"text-sm text-white/70"},"Pickup Date & Time",-1)),e("div",Le,s(l(t.booking.pickup_datetime)),1)]),e("div",null,[n[3]||(n[3]=e("span",{class:"text-sm text-white/70"},"Estimated Return",-1)),e("div",Ne,s(t.estimatedReturn),1)])]),e("div",Ve,[i.value?(d(),u("div",Ue,[n[9]||(n[9]=e("h3",{class:"text-lg font-semibold text-white mb-4"}," üí∞ Applied Overcharges ",-1)),e("div",Ie,[(d(!0),u(L,null,N(t.booking.overcharges,o=>(d(),u("div",{key:o.id,class:"bg-red-500/10 border border-red-500/20 rounded-lg p-4"},[e("div",He,[e("div",null,[e("div",Ye,s(b(o.overcharge_type_id)),1),e("div",qe,s(y(o.details)),1),e("div",ze," Applied on "+s(l(o.occurred_at)),1)]),e("div",Ee,[e("div",Ge,"‚Ç±"+s(o.amount),1),e("div",{class:j([o.is_paid?"text-green-400":"text-orange-400","text-xs font-medium"])},s(o.is_paid?"‚úÖ PAID":"‚è≥ PENDING"),3)])])]))),128))]),e("div",Qe,[e("div",We,[e("div",Je,[n[4]||(n[4]=e("span",null,"Base Rental:",-1)),e("span",Ke,"‚Ç±"+s(t.booking.total_amount),1)]),e("div",Xe,[n[5]||(n[5]=e("span",null,"Total Overcharges:",-1)),e("span",Ze,"‚Ç±"+s(g.value),1)]),e("div",et,[n[6]||(n[6]=e("span",null,"Paid Overcharges:",-1)),e("span",tt,"‚Ç±"+s(a.value),1)]),e("div",ot,[n[7]||(n[7]=e("span",null,"Pending Collection:",-1)),e("span",nt,"‚Ç±"+s(k.value),1)])]),e("div",st,[e("div",it,[n[8]||(n[8]=e("span",null,"Grand Total:",-1)),e("span",null,"‚Ç±"+s($.value),1)])])])])):x("",!0)])]))}},at={key:0,class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},lt={class:"flex items-center justify-between mb-4"},dt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ct={class:"bg-gray-800/60 backdrop-blur-sm border border-gray-600/30 rounded-lg p-3"},ut={class:"bg-gray-800/60 backdrop-blur-sm border border-gray-600/30 rounded-lg p-3"},gt={class:"font-semibold text-white"},mt={key:0,class:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4"},bt={class:"space-y-3"},ht={class:"flex justify-between items-start"},ft={class:"font-medium text-yellow-300"},vt={class:"text-sm text-gray-300"},xt={class:"text-xs text-gray-400 mt-1"},kt={class:"text-right"},yt={class:"font-bold text-yellow-300"},pt={class:"mt-4 pt-3 border-t border-yellow-500/20"},wt={key:1,class:"bg-red-500/10 border border-red-500/20 rounded-lg p-4"},$t={class:"flex items-start"},Ct={class:"flex-1"},Ot={class:"text-sm text-red-200 mt-1"},Bt={class:"mt-4 pt-3 border-t border-red-500/20"},_t={key:2,class:"bg-green-500/10 border border-green-500/20 rounded-lg p-4"},Tt={__name:"LiveOverchargeTracking",props:{booking:Object,expectedReturnTime:String,estimatedReturn:String,potentialOvercharges:Array},emits:["refreshOverchargeStatus","contactRenter"],setup(t){const r=t,i=w(()=>{const f=new Date,b=new Date(r.expectedReturnTime||r.estimatedReturn).getTime()-f.getTime(),y=Math.floor(b/(1e3*60*60)),C=Math.floor(b%(1e3*60*60)/(1e3*60));if(b<=0){const m=Math.floor(Math.abs(b)/36e5),n=Math.floor(Math.abs(b)%(1e3*60*60)/(1e3*60));return{isOverdue:!0,text:m>0?`${m}h ${n}m overdue`:`${n}m overdue`}}return{isOverdue:!1,text:y>0?`${y}h ${C}m remaining`:`${C}m remaining`}});function g(f){return new Date(f).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function a(f){return{1:"‚è∞ Late Return",2:"üèôÔ∏è Out of City Use"}[f]||"Unknown Overcharge"}function k(f){return f.replace(/Late return by ([\d.]+) hours/g,(l,b)=>{const y=parseFloat(b);return`Late return by ${$(y)}`})}function $(f){if(!f||f<=0)return"0 minutes";if(f<1){const l=Math.round(f*60);return l===1?"1 minute":`${l} minutes`}else{const l=Math.floor(f),b=Math.round((f-l)*60),y=l===1?"1 hour":`${l} hours`;if(b>0){const C=b===1?"1 minute":`${b} minutes`;return`${y} ${C}`}else return y}}return(f,l)=>t.booking.status==="confirmed"?(d(),u("div",at,[e("div",lt,[l[3]||(l[3]=e("h3",{class:"text-lg font-semibold text-gray-800"}," ‚ö†Ô∏è Live Overcharge Monitoring ",-1)),e("button",{onClick:l[0]||(l[0]=b=>f.$emit("refreshOverchargeStatus")),class:"text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors"}," üîÑ Refresh Status ")]),e("div",dt,[e("div",ct,[l[4]||(l[4]=e("div",{class:"text-sm text-gray-300"},"Current Status",-1)),e("div",{class:j(i.value.isOverdue?"text-red-400 font-bold":"text-green-400 font-semibold")},s(i.value.text),3)]),e("div",ut,[l[5]||(l[5]=e("div",{class:"text-sm text-gray-300"},"Expected Return",-1)),e("div",gt,s(g(t.expectedReturnTime||t.estimatedReturn)),1)])]),t.potentialOvercharges&&t.potentialOvercharges.length>0?(d(),u("div",mt,[l[7]||(l[7]=e("h4",{class:"font-semibold text-yellow-300 mb-3"}," üö® Active Overcharges Detected ",-1)),e("div",bt,[(d(!0),u(L,null,N(t.potentialOvercharges,b=>(d(),u("div",{key:b.overcharge_type_id,class:"bg-gray-800/60 backdrop-blur-sm border border-gray-600/30 rounded p-3 border-l-4 border-yellow-400"},[e("div",ht,[e("div",null,[e("div",ft,s(a(b.overcharge_type_id)),1),e("div",vt,s(k(b.details)),1),e("div",xt,s(b.overcharge_type_id===1?$(b.units):`${b.units} km`)+" √ó ‚Ç±"+s(b.rate_applied)+" per "+s(b.overcharge_type_id===1?"hour":"km"),1)]),e("div",kt,[e("div",yt,"‚Ç±"+s(b.amount),1),l[6]||(l[6]=e("div",{class:"text-xs text-yellow-400"},"Will be applied at completion",-1))])])]))),128))]),e("div",pt,[e("button",{onClick:l[1]||(l[1]=b=>f.$emit("contactRenter")),class:"w-full bg-yellow-600 hover:bg-yellow-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"}," üìû Contact Renter About Overcharges ")])])):t.booking.status==="confirmed"&&i.value.isOverdue?(d(),u("div",wt,[e("div",$t,[l[10]||(l[10]=e("div",{class:"text-red-400 mr-3"},"‚ö†Ô∏è",-1)),e("div",Ct,[l[8]||(l[8]=e("div",{class:"font-semibold text-red-300"},"Vehicle is Overdue - Potential Overcharges",-1)),e("div",Ot," This rental is "+s(i.value.text)+". Overcharges may apply when the booking is completed. ",1),l[9]||(l[9]=e("div",{class:"text-xs text-red-300 mt-2"}," Automatic overcharge calculation will occur when the booking is marked as completed. Contact the renter to discuss return or extension options. ",-1))])]),e("div",Bt,[e("button",{onClick:l[2]||(l[2]=b=>f.$emit("contactRenter")),class:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"}," üìû Contact Renter - Vehicle Overdue ")])])):t.booking.status==="confirmed"?(d(),u("div",_t,l[11]||(l[11]=[e("div",{class:"flex items-center"},[e("div",{class:"text-green-400 mr-3"},"‚úÖ"),e("div",null,[e("div",{class:"font-semibold text-green-300"},"No Overcharges Detected"),e("div",{class:"text-sm text-green-200"},"Rental is proceeding normally within guidelines")])],-1)]))):x("",!0)])):x("",!0)}},Mt={key:0,class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},Rt={class:"bg-gray-800/60 backdrop-blur-sm border border-gray-600/30 rounded-lg p-4 mb-4"},jt={class:"space-y-2 text-sm text-gray-300"},Pt={class:"flex justify-between"},Ft={class:"text-white"},At={class:"flex justify-between"},St={class:"text-white"},Dt={class:"flex justify-between font-semibold text-green-400 border-t border-gray-600/30 pt-2"},Lt={key:0,class:"bg-red-500/10 border border-red-500/20 rounded-lg p-4 mb-4"},Nt={class:"space-y-3"},Vt={class:"flex justify-between items-start"},Ut={class:"font-medium text-red-300"},It={class:"text-sm text-gray-300"},Ht={class:"text-xs text-gray-400 mt-1"},Yt={class:"text-right"},qt={class:"font-semibold text-red-600"},zt={class:"border-t pt-3"},Et={class:"flex justify-between font-semibold text-red-600"},Gt={class:"flex justify-between text-sm text-gray-600"},Qt={class:"text-green-600"},Wt={class:"flex justify-between text-sm text-gray-600"},Jt={class:"text-orange-600"},Kt={key:1,class:"bg-green-500/10 border border-green-500/20 rounded-lg p-4 mb-4"},Xt={class:"flex items-center"},Zt={class:"text-sm text-green-200"},eo={class:"mt-3 pt-3 border-t border-green-500/20 text-xs text-gray-400"},to={class:"mt-3 pt-3 border-t border-green-500/20"},oo=["disabled"],no={class:"mt-3 pt-3 border-t border-green-200"},so={class:"bg-gray-800 text-white rounded-lg p-4"},io={class:"flex justify-between items-center"},ro={class:"text-right"},ao={class:"text-2xl font-bold"},lo={class:"text-sm text-gray-300"},co={key:0,class:"mt-4 pt-4 border-t border-gray-600"},uo={class:"space-y-2"},go=["onClick","disabled"],mo={__name:"FinalPaymentBreakdown",props:{booking:Object,expectedReturnTime:String,estimatedReturn:String,processing:Boolean},emits:["recalculateOvercharges","toggleManualOverchargeForm","markOverchargeAsPaid"],setup(t){const r=t,i=w(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.reduce((n,o)=>n+parseFloat(o.amount||0),0)),g=w(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.filter(n=>n.is_paid).reduce((n,o)=>n+parseFloat(o.amount||0),0)),a=w(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.filter(n=>!n.is_paid).reduce((n,o)=>n+parseFloat(o.amount||0),0)),k=w(()=>{const n=parseFloat(r.booking.total_amount||0),o=i.value;return n+o}),$=w(()=>!r.booking.overcharges||r.booking.overcharges.length===0?!0:r.booking.overcharges.every(n=>n.is_paid)),f=w(()=>r.booking.overcharges?r.booking.overcharges.filter(n=>!n.is_paid):[]);function l(n){return n==null||isNaN(n)?"0.00":parseFloat(n).toFixed(2)}function b(n){return new Date(n).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function y(n){return{1:"‚è∞ Late Return",2:"üèôÔ∏è Out of City Use"}[n]||"Unknown Overcharge"}function C(n){return n.replace(/Late return by ([\d.]+) hours/g,(o,c)=>{const B=parseFloat(c);return`Late return by ${m(B)}`})}function m(n){if(!n||n<=0)return"0 minutes";if(n<1){const o=Math.round(n*60);return o===1?"1 minute":`${o} minutes`}else{const o=Math.floor(n),c=Math.round((n-o)*60),B=o===1?"1 hour":`${o} hours`;if(c>0){const M=c===1?"1 minute":`${c} minutes`;return`${B} ${M}`}else return B}}return(n,o)=>t.booking.status==="completed"?(d(),u("div",Mt,[o[15]||(o[15]=e("h2",{class:"text-xl font-semibold mb-4 text-white"}," üí∞ Final Payment Breakdown ",-1)),e("div",Rt,[o[5]||(o[5]=e("h3",{class:"text-lg font-medium text-white mb-3 flex items-center"}," üéØ Base Rental Fee ",-1)),e("div",jt,[e("div",Pt,[o[2]||(o[2]=e("span",null,"Duration:",-1)),e("span",Ft,s(t.booking.pricing_tier.duration_from)+" "+s(t.booking.pricing_tier.duration_unit),1)]),e("div",At,[o[3]||(o[3]=e("span",null,"Rate:",-1)),e("span",St,"‚Ç±"+s(t.booking.pricing_tier.price),1)]),e("div",Dt,[o[4]||(o[4]=e("span",null,"Base Total:",-1)),e("span",null,"‚Ç±"+s(t.booking.total_amount),1)])])]),t.booking.overcharges&&t.booking.overcharges.length>0?(d(),u("div",Lt,[o[9]||(o[9]=e("h3",{class:"text-lg font-medium text-red-300 mb-3 flex items-center"}," ‚ö†Ô∏è Additional Overcharge Fees ",-1)),e("div",Nt,[(d(!0),u(L,null,N(t.booking.overcharges,c=>(d(),u("div",{key:c.id,class:"bg-gray-800/60 backdrop-blur-sm border border-gray-600/30 rounded p-3"},[e("div",Vt,[e("div",null,[e("div",Ut,s(y(c.overcharge_type_id)),1),e("div",It,s(C(c.details)),1),e("div",Ht,s(c.units)+" "+s(c.overcharge_type_id===1?"hours":"km")+" √ó ‚Ç±"+s(c.rate_applied),1)]),e("div",Yt,[e("div",qt,"‚Ç±"+s(c.amount),1),e("div",{class:j([c.is_paid?"text-green-600":"text-orange-600","text-xs font-medium"])},s(c.is_paid?"‚úÖ PAID":"‚è≥ PENDING"),3)])])]))),128)),e("div",zt,[e("div",Et,[o[6]||(o[6]=e("span",null,"Total Overcharges:",-1)),e("span",null,"‚Ç±"+s(i.value),1)]),e("div",Gt,[o[7]||(o[7]=e("span",null,"Paid:",-1)),e("span",Qt,"‚Ç±"+s(g.value),1)]),e("div",Wt,[o[8]||(o[8]=e("span",null,"Pending:",-1)),e("span",Jt,"‚Ç±"+s(a.value),1)])])])])):(d(),u("div",Kt,[e("div",Xt,[o[11]||(o[11]=e("div",{class:"text-green-400 mr-3"},"‚úÖ",-1)),e("div",null,[o[10]||(o[10]=e("div",{class:"font-semibold text-green-300"},"Clean Rental - No Overcharges",-1)),e("div",Zt," Rental completed without any violations. Total earned: ‚Ç±"+s(l(t.booking.total_amount)),1)])]),e("div",eo,[e("div",null,"Expected Return: "+s(t.expectedReturnTime||t.estimatedReturn),1),e("div",null,"Actual Return: "+s(t.booking.return_time?b(t.booking.return_time):"Not set"),1),e("div",null,"Overcharges Array: "+s(t.booking.overcharges?t.booking.overcharges.length:"null")+" items",1),e("div",null,"Has Overcharges Flag: "+s(t.booking.has_overcharges?"true":"false"),1),e("div",null,"Total Overcharges Amount: ‚Ç±"+s(l(t.booking.total_overcharges||0)),1)]),e("div",to,[e("button",{onClick:o[0]||(o[0]=c=>n.$emit("recalculateOvercharges")),disabled:t.processing,class:"text-sm bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-400 text-white font-medium py-2 px-3 rounded transition-colors disabled:cursor-not-allowed"}," üîÑ Recalculate Overcharges ",8,oo),o[12]||(o[12]=e("div",{class:"text-xs text-gray-400 mt-1"}," Click if this booking should have overcharges but doesn't show any ",-1))]),e("div",no,[e("button",{onClick:o[1]||(o[1]=c=>n.$emit("toggleManualOverchargeForm")),class:"text-sm bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-3 rounded transition-colors"}," ‚ûï Add Manual Overcharge ")])])),e("div",so,[e("div",io,[o[13]||(o[13]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"Total Amount Due"),e("p",{class:"text-sm text-gray-300"},"Base rental + overcharges")],-1)),e("div",ro,[e("div",ao,"‚Ç±"+s(k.value),1),e("div",lo,s($.value?"‚úÖ Fully Paid":"‚è≥ Partial Payment"),1)])]),f.value.length>0?(d(),u("div",co,[o[14]||(o[14]=e("h4",{class:"text-sm font-medium mb-2"},"Overcharge Collection Actions:",-1)),e("div",uo,[(d(!0),u(L,null,N(f.value,c=>(d(),u("button",{key:c.id,onClick:B=>n.$emit("markOverchargeAsPaid",c.id),disabled:t.processing,class:"text-xs bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-medium py-1 px-2 rounded transition-colors disabled:cursor-not-allowed"}," Mark "+s(y(c.overcharge_type_id))+" as Paid (‚Ç±"+s(l(c.amount))+") ",9,go))),128))])])):x("",!0)])])):x("",!0)}},bo={key:0,class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},ho={class:"bg-red-50/10 border border-red-200/30 rounded p-4"},fo={class:"space-y-4"},vo={class:"flex space-x-3 pt-2"},xo=["disabled"],ko={key:0,class:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg"},yo={class:"text-sm text-gray-300"},po={class:"flex justify-between"},wo={class:"flex justify-between"},$o={class:"font-semibold text-red-400"},Co={key:0,class:"mt-2"},Oo={class:"text-xs text-gray-300 mt-1"},Bo={__name:"ManualOverchargeForm",props:{showManualOverchargeForm:Boolean,manualOvercharge:Object,processing:Boolean},emits:["addManualOvercharge","close"],setup(t){function r(g){return{1:"‚è∞ Late Return",2:"üèôÔ∏è Out of City Use"}[g]||"Unknown Overcharge"}function i(g){return g==null||isNaN(g)?"0.00":parseFloat(g).toFixed(2)}return(g,a)=>t.showManualOverchargeForm?(d(),u("div",bo,[a[13]||(a[13]=e("h3",{class:"text-lg font-semibold text-white mb-4"},"‚ûï Add Manual Overcharge",-1)),e("div",ho,[e("div",fo,[e("div",null,[a[6]||(a[6]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Overcharge Type",-1)),U(e("select",{"onUpdate:modelValue":a[0]||(a[0]=k=>t.manualOvercharge.type=k),class:"w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-red-500 focus:ring-red-500"},a[5]||(a[5]=[e("option",{value:"1"},"‚è∞ Late Return",-1),e("option",{value:"2"},"üèôÔ∏è Out of City Use",-1)]),512),[[K,t.manualOvercharge.type]])]),e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Amount (‚Ç±)",-1)),U(e("input",{"onUpdate:modelValue":a[1]||(a[1]=k=>t.manualOvercharge.amount=k),type:"number",step:"0.01",min:"0",class:"w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-red-500 focus:ring-red-500",placeholder:"Enter overcharge amount"},null,512),[[q,t.manualOvercharge.amount]])]),e("div",null,[a[8]||(a[8]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Description",-1)),U(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=k=>t.manualOvercharge.details=k),class:"w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-red-500 focus:ring-red-500",rows:"3",placeholder:"Reason for this overcharge..."},null,512),[[q,t.manualOvercharge.details]])]),e("div",vo,[e("button",{onClick:a[3]||(a[3]=k=>g.$emit("addManualOvercharge",t.manualOvercharge)),disabled:t.processing||!t.manualOvercharge.amount||parseFloat(t.manualOvercharge.amount)<=0,class:"flex-1 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:cursor-not-allowed"},s(t.processing?"Adding...":"Add Overcharge"),9,xo),e("button",{onClick:a[4]||(a[4]=k=>g.$emit("close")),class:"flex-1 bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"}," Cancel ")])])]),t.manualOvercharge.amount&&parseFloat(t.manualOvercharge.amount)>0?(d(),u("div",ko,[a[12]||(a[12]=e("h4",{class:"text-sm font-medium text-yellow-300 mb-2"},"Preview",-1)),e("div",yo,[e("div",po,[a[9]||(a[9]=e("span",null,"Type:",-1)),e("span",null,s(r(parseInt(t.manualOvercharge.type))),1)]),e("div",wo,[a[10]||(a[10]=e("span",null,"Amount:",-1)),e("span",$o,"‚Ç±"+s(i(t.manualOvercharge.amount)),1)]),t.manualOvercharge.details?(d(),u("div",Co,[a[11]||(a[11]=e("span",{class:"text-xs text-gray-400"},"Description:",-1)),e("p",Oo,s(t.manualOvercharge.details),1)])):x("",!0)])])):x("",!0)])):x("",!0)}},_o={key:0,class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow"},To={class:"flex items-center justify-between mb-4"},Mo={class:"bg-gray-800/40 rounded-lg p-4 border border-gray-600/30"},Ro={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},jo={class:"lg:col-span-1"},Po={class:"bg-white/5 p-4 rounded-lg border border-white/20"},Fo=["src"],Ao={class:"lg:col-span-2 space-y-4"},So={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Do={class:"bg-gray-700/30 p-4 rounded-lg"},Lo={class:"font-semibold text-white"},No={class:"bg-gray-700/30 p-4 rounded-lg"},Vo={class:"font-semibold text-green-400 text-lg"},Uo={key:0,class:"bg-gray-700/30 p-4 rounded-lg md:col-span-2 md:justify-self-center"},Io={class:"font-mono text-white text-sm break-all"},Ho={class:"bg-gray-700/30 p-4 rounded-lg md:col-span-2 md:justify-self-center"},Yo={class:"font-semibold text-white"},qo={__name:"PaymentProof",props:{booking:Object},emits:["open-receipt-modal"],setup(t){function r(g){return g==null||isNaN(g)?"0.00":parseFloat(g).toFixed(2)}function i(g){return new Date(g).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}return(g,a)=>{var k,$,f,l,b,y;return(k=t.booking.payment)!=null&&k.receipt_image?(d(),u("div",_o,[e("div",To,[a[1]||(a[1]=e("h2",{class:"text-xl font-semibold text-white flex items-center"},[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),V(" Payment Proof Submitted ")],-1)),e("span",{class:j([($=t.booking.payment)!=null&&$.paid_at?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800","inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"])},s((f=t.booking.payment)!=null&&f.paid_at?"‚úì Verified":"‚ö† Pending Verification"),3)]),e("div",Mo,[e("div",Ro,[e("div",jo,[e("div",Po,[a[2]||(a[2]=e("p",{class:"text-sm text-white/70 mb-3 font-medium text-center"},"Payment Receipt",-1)),e("img",{src:t.booking.payment.receipt_image,alt:"Payment Receipt",class:"w-full h-64 object-cover rounded border border-gray-600/30 cursor-pointer hover:opacity-75 transition-opacity",onClick:a[0]||(a[0]=C=>g.$emit("open-receipt-modal",t.booking.payment.receipt_image))},null,8,Fo)])]),e("div",Ao,[e("div",So,[e("div",Do,[a[3]||(a[3]=e("p",{class:"text-sm text-white/70 mb-1"},"Payment Method",-1)),e("p",Lo,s(((b=(l=t.booking.payment)==null?void 0:l.payment_mode)==null?void 0:b.name)||"N/A"),1)]),e("div",No,[a[4]||(a[4]=e("p",{class:"text-sm text-white/70 mb-1"},"Amount Paid",-1)),e("p",Vo,"‚Ç±"+s(r(t.booking.total_amount)),1)]),(y=t.booking.payment)!=null&&y.reference_number?(d(),u("div",Uo,[a[5]||(a[5]=e("p",{class:"text-sm text-white/70 mb-1"},"Reference Number",-1)),e("p",Io,s(t.booking.payment.reference_number),1)])):x("",!0),e("div",Ho,[a[6]||(a[6]=e("p",{class:"text-sm text-white/70 mb-1"},"Submitted",-1)),e("p",Yo,s(i(t.booking.payment.created_at)),1)])]),a[7]||(a[7]=X('<div class="bg-blue-500/10 border border-blue-500/20 rounded-lg p-4"><div class="flex items-start space-x-3"><div class="text-blue-400">‚ÑπÔ∏è</div><div class="flex-1"><h4 class="font-semibold text-blue-300 mb-2">Verification Instructions</h4><ul class="text-sm text-blue-200 space-y-1"><li>‚Ä¢ Verify the payment amount matches the booking total</li><li>‚Ä¢ Check the reference number against your payment records</li><li>‚Ä¢ Confirm the payment timestamp is reasonable</li><li>‚Ä¢ Contact the customer if any discrepancies are found</li></ul></div></div></div>',1))])])])])):x("",!0)}}},zo={class:"glass-card border border-white/20 rounded-lg p-6 bg-white/5 backdrop-blur-sm shadow-glow sticky top-6"},Eo={class:"mb-6"},Go={class:"mt-1"},Qo={class:"mt-2 text-sm text-white"},Wo={key:0,class:"mt-3 pt-2 border-t"},Jo={class:"mt-1"},Ko={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Xo={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800"},Zo={class:"mt-1 text-xs text-gray-500"},en={class:"space-y-3"},tn={key:0,class:"space-y-3"},on=["disabled"],nn=["disabled"],sn=["disabled"],rn=["disabled"],an={key:2,class:"p-3 bg-green-500/10 border border-green-500/20 rounded"},ln={key:3,class:"p-3 bg-red-500/10 border border-red-500/20 rounded"},dn={class:"border-t border-gray-600/30 pt-4 mt-6"},cn={__name:"ActionsSidebar",props:{booking:Object,processing:Boolean},emits:["confirmPayment","confirmBooking","rejectBooking","completeBooking","goToVehicle"],setup(t,{emit:r}){const i=t,g=r,a=w(()=>i.booking.overcharges&&i.booking.overcharges.length>0),k=w(()=>!i.booking.overcharges||i.booking.overcharges.length===0?!0:i.booking.overcharges.every(o=>o.is_paid)),$=w(()=>i.booking.overcharges?i.booking.overcharges.filter(o=>!o.is_paid):[]),f=w(()=>!i.booking.overcharges||i.booking.overcharges.length===0?0:i.booking.overcharges.filter(o=>!o.is_paid).reduce((o,c)=>o+parseFloat(c.amount||0),0));function l(o){return o?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}function b(o){return o==null||isNaN(o)?"0.00":parseFloat(o).toFixed(2)}async function y(){(await p.fire({title:"Confirm Payment & Booking",text:"Are you sure you want to confirm this payment and booking?",icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, confirm it!",cancelButtonText:"Cancel",background:"#1f2937",color:"#fff",customClass:{popup:"swal-dark-popup"}})).isConfirmed&&g("confirmPayment")}async function C(){(await p.fire({title:"Confirm Booking",text:"Are you sure you want to confirm this booking?",icon:"question",showCancelButton:!0,confirmButtonColor:"#2563eb",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, confirm it!",cancelButtonText:"Cancel",background:"#1f2937",color:"#fff",customClass:{popup:"swal-dark-popup"}})).isConfirmed&&g("confirmBooking")}async function m(){(await p.fire({title:"Reject Booking",text:"Are you sure you want to reject this booking? This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, reject it",cancelButtonText:"Cancel",background:"#1f2937",color:"#fff",customClass:{popup:"swal-dark-popup"}})).isConfirmed&&g("rejectBooking")}async function n(){(await p.fire({title:"Mark as Completed",text:"Are you sure you want to mark this booking as completed?",icon:"question",showCancelButton:!0,confirmButtonColor:"#9333ea",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, complete it!",cancelButtonText:"Cancel",background:"#1f2937",color:"#fff",customClass:{popup:"swal-dark-popup"}})).isConfirmed&&g("completeBooking")}return(o,c)=>{var B,M,P,F,A,S,D;return d(),u("div",zo,[c[6]||(c[6]=e("h2",{class:"text-xl font-semibold mb-4 text-white"}," Actions ",-1)),e("div",Eo,[c[3]||(c[3]=e("span",{class:"text-sm text-white"},"Payment Status",-1)),e("div",Go,[e("span",{class:j([l((B=t.booking.payment)==null?void 0:B.paid_at),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},s((M=t.booking.payment)!=null&&M.paid_at?"Payment Confirmed":"Payment Pending"),3)]),e("div",Qo,[c[1]||(c[1]=e("span",{class:"font-medium"},"Method:",-1)),V(" "+s(((F=(P=t.booking.payment)==null?void 0:P.payment_mode)==null?void 0:F.name)||"N/A"),1)]),t.booking.status==="completed"&&a.value?(d(),u("div",Wo,[c[2]||(c[2]=e("span",{class:"text-sm text-gray-500"},"Overcharge Status",-1)),e("div",Jo,[k.value?(d(),u("span",Ko," ‚úÖ All Overcharges Paid ")):(d(),u("span",Xo," ‚è≥ "+s($.value.length)+" Pending Payment(s) ",1))]),e("div",Zo," Outstanding: ‚Ç±"+s(b(f.value)),1)])):x("",!0)]),e("div",en,[t.booking.status==="pending"?(d(),u("div",tn,[(A=t.booking.payment)!=null&&A.receipt_image&&!t.booking.payment.paid_at?(d(),u("button",{key:0,onClick:y,disabled:t.processing,class:"w-full py-2 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(t.processing?"Processing...":"Confirm Payment & Booking"),9,on)):x("",!0),((S=t.booking.payment)==null?void 0:S.type)==="cod"||(D=t.booking.payment)!=null&&D.paid_at?(d(),u("button",{key:1,onClick:C,disabled:t.processing,class:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(t.processing?"Processing...":"Confirm Booking"),9,nn)):x("",!0),e("button",{onClick:m,disabled:t.processing,class:"w-full py-2 px-4 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(t.processing?"Processing...":"Reject Booking"),9,sn)])):x("",!0),t.booking.status==="confirmed"?(d(),u("button",{key:1,onClick:n,disabled:t.processing,class:"w-full py-2 px-4 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(t.processing?"Processing...":"Mark as Completed"),9,rn)):x("",!0),t.booking.status==="completed"?(d(),u("div",an,c[4]||(c[4]=[e("div",{class:"text-green-300 font-medium text-sm"}," Booking Completed ",-1),e("div",{class:"text-green-200 text-xs mt-1"}," This booking has been marked as completed. ",-1)]))):x("",!0),t.booking.status==="cancelled"?(d(),u("div",ln,c[5]||(c[5]=[e("div",{class:"text-red-300 font-medium text-sm"}," Booking Cancelled ",-1),e("div",{class:"text-red-200 text-xs mt-1"}," This booking has been cancelled. ",-1)]))):x("",!0)]),e("div",dn,[e("button",{onClick:c[0]||(c[0]=I=>o.$emit("goToVehicle")),class:"w-full py-2 px-4 border border-gray-600/30 text-gray-300 hover:bg-gray-700/40 font-semibold rounded-lg transition-colors"}," View Vehicle ")])])}}},un=G(cn,[["__scopeId","data-v-a37ad768"]]),gn={class:"py-12"},mn={class:"max-w-6xl mx-auto sm:px-6 lg:px-8"},bn={class:"glass-card-dark overflow-hidden shadow-glow sm:rounded-lg"},hn={class:"p-6 text-white"},fn={class:"mb-6"},vn={class:"text-3xl font-bold text-white"},xn={class:"flex items-center space-x-4 mt-2"},kn={class:"text-sm text-white/70"},yn={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},pn={class:"lg:col-span-2 space-y-6"},wn={class:"lg:col-span-1"},$n={class:"bg-gray-800 border border-gray-600/30 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto"},Cn={class:"p-4 border-b border-gray-600/30 flex justify-between items-center"},On={class:"text-lg font-semibold text-white"},Bn={class:"p-4 text-center"},_n=["src"],Tn={class:"bg-gray-800 border border-gray-600/30 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto"},Mn={class:"p-4 text-center"},Rn=["src"],jn={__name:"Show",props:{booking:Object,expectedReturnTime:String,potentialOvercharges:Array,recentOvercharges:Array,stats:Object},setup(t){const r=t,i=R(!1),g=R(!1),a=R({type:"1",amount:"",details:""}),k=R(!1),$=R({side:"",imageUrl:""}),f=R(!1),l=R(""),b=w(()=>{const h=new Date(r.booking.pickup_datetime),v=r.booking.pricing_tier;let _=new Date(h);switch(v.duration_unit){case"minutes":_.setMinutes(_.getMinutes()+v.duration_from);break;case"hours":_.setHours(_.getHours()+v.duration_from);break;case"days":_.setDate(_.getDate()+v.duration_from);break}return _.toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})});function y(h){return{pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[h]||"bg-gray-100 text-gray-800"}function C(h){return{pending:"Pending",confirmed:"Confirmed",completed:"Completed",cancelled:"Cancelled"}[h]||h}function m(h){return new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function n(){O.visit(route("owner.bookings.index"))}function o(){O.visit(route("vehicles.show",r.booking.vehicle.id))}function c(){i.value=!0,O.post(route("owner.bookings.confirmPayment",r.booking.id),{},{onFinish:()=>{i.value=!1}})}function B(){p.fire({title:"Confirm Booking?",text:"Are you sure you want to confirm this booking?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, Confirm It",cancelButtonText:"Cancel"}).then(h=>{h.isConfirmed&&(i.value=!0,O.post(route("owner.bookings.confirm",r.booking.id),{},{onFinish:()=>{i.value=!1},onSuccess:()=>{p.fire({title:"Confirmed!",text:"The booking has been confirmed.",icon:"success",confirmButtonColor:"#3b82f6"})}}))})}function M(){p.fire({title:"Reject Booking?",text:"Are you sure you want to reject this booking? This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, Reject It",cancelButtonText:"Cancel"}).then(h=>{h.isConfirmed&&(i.value=!0,O.post(route("owner.bookings.reject",r.booking.id),{},{onFinish:()=>{i.value=!1},onSuccess:()=>{p.fire({title:"Rejected!",text:"The booking has been rejected.",icon:"success",confirmButtonColor:"#3b82f6"})}}))})}function P(){p.fire({title:"Complete Booking?",text:"Are you sure you want to mark this booking as completed? This will calculate any applicable overcharges.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, Complete It",cancelButtonText:"Cancel"}).then(h=>{h.isConfirmed&&(i.value=!0,O.post(route("owner.bookings.complete",r.booking.id),{},{onFinish:()=>{i.value=!1},onSuccess:()=>{p.fire({title:"Completed!",text:"The booking has been marked as completed.",icon:"success",confirmButtonColor:"#3b82f6"}),O.reload()}}))})}function F(h){p.fire({title:"Mark as Paid?",text:"Mark this overcharge as paid?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, Mark as Paid",cancelButtonText:"Cancel"}).then(v=>{v.isConfirmed&&(i.value=!0,O.post(route("owner.overcharges.markAsPaid",h),{},{onFinish:()=>{i.value=!1},onSuccess:()=>{p.fire({title:"Updated!",text:"Overcharge has been marked as paid.",icon:"success",confirmButtonColor:"#3b82f6"}),O.reload({only:["booking"]})}}))})}function A(){O.reload({only:["booking","expectedReturnTime","potentialOvercharges"]})}function S(){p.fire({title:"Recalculate Overcharges?",text:"This will recalculate overcharges for this completed booking. Continue?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, Recalculate",cancelButtonText:"Cancel"}).then(h=>{h.isConfirmed&&(i.value=!0,O.post(route("overcharges.calculate",r.booking.id),{},{onFinish:()=>{i.value=!1},onSuccess:()=>{p.fire({title:"Recalculated!",text:"Overcharges have been recalculated.",icon:"success",confirmButtonColor:"#3b82f6"}),O.reload()}}))})}function D(h){if(!h.amount||parseFloat(h.amount)<=0){p.fire({title:"Invalid Amount",text:"Please enter a valid amount",icon:"error",confirmButtonColor:"#3b82f6"});return}p.fire({title:"Add Overcharge?",text:`Add ‚Ç±${h.amount} overcharge to this booking?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, Add It",cancelButtonText:"Cancel"}).then(v=>{if(v.isConfirmed){i.value=!0;const _={overcharge_type_id:parseInt(h.type),amount:parseFloat(h.amount),details:h.details||"Manual overcharge added by owner",units:1,rate_applied:parseFloat(h.amount),is_paid:!1,occurred_at:new Date().toISOString()};O.post(route("owner.overcharges.add",r.booking.id),_,{onFinish:()=>{i.value=!1},onSuccess:()=>{p.fire({title:"Added!",text:"Overcharge has been added successfully.",icon:"success",confirmButtonColor:"#3b82f6"}),a.value={type:"1",amount:"",details:""},g.value=!1,O.reload()}})}})}function I(){const h=r.booking.user.phone,v=r.booking.user.email;if(h)window.open(`tel:${h}`,"_self");else if(v){const _=encodeURIComponent(`Regarding Your Booking #${r.booking.id} - Overcharge Notice`),J=encodeURIComponent(`Hello ${r.booking.user.first_name},

This is regarding your current vehicle rental booking (#${r.booking.id}).

We've detected some potential overcharges that may apply to your rental. Please contact us to discuss.

Best regards,
Your Vehicle Owner`);window.open(`mailto:${v}?subject=${_}&body=${J}`,"_self")}else alert("No contact information available for this renter.")}function Q(h,v){$.value={side:h,imageUrl:v},k.value=!0}function H(){k.value=!1,$.value={side:"",imageUrl:""}}function W(h){l.value=h,f.value=!0}function Y(){f.value=!1,l.value=""}return(h,v)=>(d(),z(ee,null,{default:Z(()=>[e("div",gn,[e("div",mn,[e("div",bn,[e("div",hn,[e("div",{class:"mb-6"},[e("button",{onClick:n,class:"inline-flex items-center text-white hover:text-gray-400 font-semibold transition-colors"},v[2]||(v[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),V(" Back to Booking Requests ")]))]),e("div",fn,[e("h1",vn," Booking #"+s(t.booking.id),1),e("div",xn,[e("span",{class:j([y(t.booking.status),"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"])},s(C(t.booking.status)),3),e("span",kn," Requested "+s(m(t.booking.created_at)),1)])]),e("div",yn,[e("div",pn,[T(ae,{booking:t.booking},null,8,["booking"]),T(pe,{booking:t.booking,onOpenLicenseModal:Q},null,8,["booking"]),T(Pe,{booking:t.booking},null,8,["booking"]),T(rt,{booking:t.booking,"estimated-return":b.value},null,8,["booking","estimated-return"]),T(Tt,{booking:t.booking,"expected-return-time":t.expectedReturnTime,"estimated-return":b.value,"potential-overcharges":t.potentialOvercharges,onRefreshOverchargeStatus:A,onContactRenter:I},null,8,["booking","expected-return-time","estimated-return","potential-overcharges"]),T(mo,{booking:t.booking,"expected-return-time":t.expectedReturnTime,"estimated-return":b.value,processing:i.value,onRecalculateOvercharges:S,onToggleManualOverchargeForm:v[0]||(v[0]=_=>g.value=!g.value),onMarkOverchargeAsPaid:F},null,8,["booking","expected-return-time","estimated-return","processing"]),g.value?(d(),z(Bo,{key:0,"show-manual-overcharge-form":g.value,"manual-overcharge":a.value,processing:i.value,onAddManualOvercharge:D,onClose:v[1]||(v[1]=_=>g.value=!1)},null,8,["show-manual-overcharge-form","manual-overcharge","processing"])):x("",!0),T(qo,{booking:t.booking,onOpenReceiptModal:W},null,8,["booking"])]),e("div",wn,[T(un,{booking:t.booking,processing:i.value,onConfirmPayment:c,onConfirmBooking:B,onRejectBooking:M,onCompleteBooking:P,onGoToVehicle:o},null,8,["booking","processing"])])])])])])]),k.value?(d(),u("div",{key:0,onClick:E(H,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},[e("div",$n,[e("div",Cn,[e("h3",On," Driver's License - "+s($.value.side==="front"?"Front Side":"Back Side"),1),e("button",{onClick:H,class:"text-gray-400 hover:text-gray-200 transition-colors"},v[3]||(v[3]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Bn,[e("img",{src:$.value.imageUrl,alt:"Driver's License",class:"max-w-full h-auto mx-auto rounded border"},null,8,_n)])])])):x("",!0),f.value?(d(),u("div",{key:1,onClick:E(Y,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},[e("div",Tn,[e("div",{class:"p-4 border-b border-gray-600/30 flex justify-between items-center"},[v[5]||(v[5]=e("h3",{class:"text-lg font-semibold text-white"},"Payment Receipt",-1)),e("button",{onClick:Y,class:"text-gray-400 hover:text-gray-200 transition-colors"},v[4]||(v[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Mn,[e("img",{src:l.value,alt:"Payment Receipt",class:"max-w-full h-auto mx-auto rounded border"},null,8,Rn)])])])):x("",!0)]),_:1}))}},Ln=G(jn,[["__scopeId","data-v-39b7de0d"]]);export{Ln as default};
