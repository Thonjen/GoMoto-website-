import{j as H,r as d,I as $,c as C,q as I,a as O,o as n,w as V,b as t,l as Q,f as r,i as Z,n as T,g as a,F as u,h as c,t as i,k as g,v as S,d as f,u as v,e as k,z as K,S as W,Q as X}from"./app-D5PUyAMe.js";import{_ as ee}from"./OwnerLayout-R8EC1rpz.js";import{i as te,v as oe,u as le,n as se}from"./vue-leaflet.es-eidY92mW.js";import{_ as ne}from"./FilePondUploader-Ci--PhLg.js";import{t as re}from"./throttle-Dasc37Bf.js";import"./ResponsiveNavLink-BCB-x7oE.js";import"./Footer-DI0umZVU.js";import"./Header-DdPT2WJT.js";import"./filepond-plugin-file-validate-size.esm-DLcP4GBn.js";const ie={class:"bg-white p-6 rounded-lg shadow-md max-w-4xl mx-auto"},ae={class:"grid grid-cols-2 gap-4"},de={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ue=["value"],ce=["disabled"],me={value:""},pe=["value"],ge={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},fe=["value"],be=["value"],ve=["value"],ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},xe=["value"],ke={class:"border rounded-lg p-4 bg-gray-50 shadow-sm space-y-4"},we={class:"h-72 rounded overflow-hidden border shadow"},_e={class:"space-y-2 text-sm bg-white p-4 rounded shadow-inner border"},he={class:"text-gray-600"},Me={class:"text-gray-600"},Ce={class:"flex items-center gap-2"},Ve=["href"],Te={class:"border-t pt-6"},Se={class:"flex items-center justify-between mb-4"},je=["disabled"],Fe={key:0},Le={class:"space-y-2"},$e=["value"],Ue={class:"text-sm"},Ne={key:1,class:"text-sm text-gray-500"},qe={key:2,class:"text-sm text-gray-500"},Pe={class:"text-sm text-gray-500 mt-2"},Ee={class:"border-t pt-6"},Ae=["disabled"],Oe={__name:"Create",props:{fuelTypes:Array,transmissions:Array,types:Array},setup(w){const j=w,l=H({vehicle_type:"",make_id:"",model_id:"",type_id:"",fuel_type_id:"",transmission_id:"",year:"",license_plate:"",color:"",description:"",is_available:!0,lat:9.785903415098108,lng:125.49062330098809,location_name:"Surigao del Norte, Philippines"}),F=d([]),m=d([]),_=d([]),h=d([]),y=d(!1),x=d(!1),p=d(!1),M=d(null);d(null);const U={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[125.48545720374489,9.801207813887503],[125.48394937158277,9.801134816678099],[125.4824560626428,9.800916528148765],[125.48099166020462,9.800555050821249],[125.47957026901334,9.800053866380772],[125.47820557937605,9.799417802127778],[125.47691073525756,9.79865298446448],[125.4756982076485,9.797766779865192],[125.47457967442702,9.796767723899952],[125.47356590787237,9.79566543899633],[125.47266667091462,9.79447054173279],[125.47189062311993,9.793194540557817],[125.47124523731648,9.791849724921354],[125.47073672766314,9.790449046887577],[125.47036998985222,9.789005996370452],[125.47014855402033,9.787534471194746],[125.47007455081837,9.786048643234757],[125.47014869096546,9.784562821920598],[125.47037025847982,9.78309131642699],[125.47073711764999,9.781648297871861],[125.47124573367556,9.78024766285169],[125.47189120677649,9.77890289962746],[125.47266731943903,9.77762695824917],[125.47356659634224,9.776432125868816],[125.47458037638481,9.775329908441458],[125.47569889611839,9.774330919952476],[125.47691138378202,9.773444780236375],[125.47820616303265,9.772680022369768],[125.47957076537246,9.772044010529008],[125.48099205019147,9.771542869102143],[125.48245633127043,9.771181423736623],[125.48394950852794,9.77096315488939],[125.48545720374489,9.770890164325817],[125.48696489896184,9.77096315488939],[125.48845807621933,9.771181423736623],[125.48992235729831,9.771542869102143],[125.49134364211733,9.772044010529008],[125.49270824445713,9.772680022369768],[125.49400302370776,9.773444780236375],[125.4952155113714,9.774330919952476],[125.49633403110496,9.775329908441458],[125.49734781114755,9.776432125868816],[125.49824708805076,9.77762695824917],[125.49902320071328,9.77890289962746],[125.4996686738142,9.78024766285169],[125.5001772898398,9.781648297871861],[125.50054414900994,9.78309131642699],[125.50076571652433,9.784562821920598],[125.50083985667139,9.786048643234757],[125.50076585346946,9.787534471194746],[125.50054441763756,9.789005996370452],[125.50017767982663,9.790449046887577],[125.4996691701733,9.791849724921354],[125.49902378436985,9.793194540557817],[125.49824773657517,9.79447054173279],[125.4973484996174,9.79566543899633],[125.49633473306275,9.796767723899952],[125.49521619984127,9.797766779865192],[125.49400367223222,9.79865298446448],[125.49270882811372,9.799417802127778],[125.49134413847645,9.800053866380772],[125.48992274728516,9.800555050821249],[125.48845834484696,9.800916528148765],[125.48696503590699,9.801134816678099],[125.48545720374489,9.801207813887503]]]}}]},N=re(async()=>{if(l.lat&&l.lng)try{const e=await(await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${l.lat}&lon=${l.lng}&format=json`)).json();l.location_name=e.display_name}catch{locationName.value="Unknown location",l.location_name=""}},1e3),q=()=>({color:"#1976d2",weight:2,fill:!1}),P=[[9.770890164325817,125.47007455081837],[9.801207813887503,125.50083985667139]];$(()=>[l.lat,l.lng],()=>{N()},{immediate:!0});const E=C(()=>{const s=new Date().getFullYear(),e=[];for(let o=s+1;o>=2e3;o--)e.push(o);return e}),A=C(()=>l.vehicle_type?F.value.filter(s=>s.vehicle_type===l.vehicle_type):[]),B=C(()=>{if(!l.vehicle_type)return j.types||[];const e={car:"car",motorcycle:"motorcycle"}[l.vehicle_type];return(j.types||[]).filter(o=>o.category===e)});I(async()=>{await D(),await L()}),$(()=>l.vehicle_type,()=>{l.make_id="",l.model_id="",l.type_id="",m.value=[]});async function D(){try{const s=await fetch("/api/vehicle-data/makes/car");if(s.ok){const e=await s.json(),o=await fetch("/api/vehicle-data/makes/motorcycle");if(o.ok){const b=await o.json();F.value=[...e,...b]}}}catch(s){console.error("Error loading makes:",s)}}async function L(){p.value=!0;try{const s=await fetch("/owner/pricing-tiers/list");if(s.ok){const e=await s.json();_.value=e.pricingTiers||[]}}catch(s){console.error("Error loading pricing tiers:",s)}finally{p.value=!1}}async function z(){if(!l.make_id){m.value=[];return}y.value=!0,l.model_id="";try{const s=await fetch(`/api/vehicle-data/models/${l.make_id}`);s.ok?m.value=await s.json():m.value=[]}catch(s){console.error("Error loading models:",s),m.value=[]}finally{y.value=!1}}function Y(s){M.value=s}function R(s){l.lat=s.latlng.lat,l.lng=s.latlng.lng,G(l.lat,l.lng)}async function G(s,e){try{const o=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${e}`);if(o.ok){const b=await o.json();l.location_name=b.display_name.split(",").slice(0,3).join(", ")}}catch(o){console.error("Reverse geocoding error:",o),l.location_name=`${s.toFixed(6)}, ${e.toFixed(6)}`}}function J(){x.value=!0;const s=new FormData;Object.entries(l).forEach(([e,o])=>{e==="is_available"?s.append(e,o?"1":"0"):o!==null&&o!==""&&s.append(e,o)}),M.value&&s.append("main_photo",M.value),s.append("pricing_tier_ids",JSON.stringify(h.value)),X.post("/owner/vehicles",s,{onFinish:()=>{x.value=!1},onError:e=>{console.error("Validation errors:",e)}})}return(s,e)=>(n(),O(ee,null,{default:V(()=>[t("div",ie,[e[39]||(e[39]=t("h1",{class:"text-3xl font-bold text-gray-800 mb-6"},"Add New Vehicle",-1)),t("form",{onSubmit:Q(J,["prevent"]),class:"space-y-6"},[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Vehicle Type *",-1)),t("div",ae,[t("button",{type:"button",onClick:e[0]||(e[0]=o=>l.vehicle_type="car"),class:T(["p-4 border-2 rounded-lg text-center font-medium transition-all",l.vehicle_type==="car"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"])}," 🚗 Car ",2),t("button",{type:"button",onClick:e[1]||(e[1]=o=>l.vehicle_type="motorcycle"),class:T(["p-4 border-2 rounded-lg text-center font-medium transition-all",l.vehicle_type==="motorcycle"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"])}," 🏍️ Motorcycle ",2)])]),l.vehicle_type?(n(),r("div",de,[t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Make *",-1)),a(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.make_id=o),onChange:z,class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},[e[13]||(e[13]=t("option",{value:""},"Select Make",-1)),(n(!0),r(u,null,c(A.value,o=>(n(),r("option",{key:o.id,value:o.id},i(o.name),9,ue))),128))],544),[[g,l.make_id]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Model *",-1)),a(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.model_id=o),class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!l.make_id||y.value,required:""},[t("option",me,i(y.value?"Loading...":"Select Model"),1),(n(!0),r(u,null,c(m.value,o=>(n(),r("option",{key:o.id,value:o.id},i(o.name),9,pe))),128))],8,ce),[[g,l.model_id]])])])):Z("",!0),t("div",ge,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Year *",-1)),a(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.year=o),class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},[e[16]||(e[16]=t("option",{value:""},"Select Year",-1)),(n(!0),r(u,null,c(E.value,o=>(n(),r("option",{key:o,value:o},i(o),9,fe))),128))],512),[[g,l.year]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Transmission *",-1)),a(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>l.transmission_id=o),class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},[e[18]||(e[18]=t("option",{value:""},"Select Transmission",-1)),(n(!0),r(u,null,c(w.transmissions,o=>(n(),r("option",{key:o.id,value:o.id},i(o.name),9,be))),128))],512),[[g,l.transmission_id]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fuel Type *",-1)),a(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>l.fuel_type_id=o),class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},[e[20]||(e[20]=t("option",{value:""},"Select Fuel Type",-1)),(n(!0),r(u,null,c(w.fuelTypes,o=>(n(),r("option",{key:o.id,value:o.id},i(o.name),9,ve))),128))],512),[[g,l.fuel_type_id]])])]),t("div",ye,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"License Plate",-1)),a(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>l.license_plate=o),type:"text",class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter license plate"},null,512),[[S,l.license_plate]]),e[23]||(e[23]=t("p",{class:"text-xs text-gray-500 mt-1"},"Leave blank if not assigned yet",-1))]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Color *",-1)),a(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>l.color=o),type:"text",class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter vehicle color",required:""},null,512),[[S,l.color]])])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Vehicle Sub-Type *",-1)),a(t("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>l.type_id=o),class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},[e[25]||(e[25]=t("option",{value:""},"Select Sub-Type",-1)),(n(!0),r(u,null,c(B.value,o=>(n(),r("option",{key:o.id,value:o.id},i(o.sub_type),9,xe))),128))],512),[[g,l.type_id]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),a(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=o=>l.description=o),rows:"3",class:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe your vehicle"},null,512),[[S,l.description]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Main Photo",-1)),f(ne,{onFileAdded:Y})]),t("div",ke,[t("div",we,[f(v(te),{style:{height:"100%"},zoom:20,center:[l.lat,l.lng],maxBounds:P,minZoom:15,maxZoom:18,onClick:R},{default:V(()=>[f(v(oe),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),f(v(le),{"lat-lng":[l.lat,l.lng]},null,8,["lat-lng"]),f(v(se),{geojson:U,"options-style":q})]),_:1},8,["center"])]),t("div",_e,[t("div",null,[e[29]||(e[29]=t("span",{class:"font-medium text-gray-700"},"Coordinates:",-1)),t("span",he," Lat "+i(l.lat)+", Lng "+i(l.lng),1)]),t("div",null,[e[30]||(e[30]=t("span",{class:"font-medium text-gray-700"},"Location:",-1)),t("span",Me,i(l.location_name),1)]),t("div",Ce,[e[32]||(e[32]=t("span",{class:"font-medium text-gray-700"},"Map Link:",-1)),t("a",{href:`https://www.google.com/maps?q=${l.lat},${l.lng}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center text-blue-600 hover:text-blue-800 underline transition"},e[31]||(e[31]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A2 2 0 013 15.382V5a2 2 0 012-2h14a2 2 0 012 2v10.382a2 2 0 01-1.553 1.894L15 20l-3-1.5L9 20z"})],-1),t("span",null,"View on Google Maps",-1)]),8,Ve)])])]),t("div",Te,[t("div",Se,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold"},"Pricing",-1)),t("button",{type:"button",onClick:L,disabled:p.value,class:"flex items-center px-3 py-1 text-sm text-blue-600 hover:text-blue-800 border border-blue-300 hover:border-blue-400 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[(n(),r("svg",{class:T(["w-4 h-4 mr-1",{"animate-spin":p.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),k(" "+i(p.value?"Refreshing...":"Refresh"),1)],8,je)]),_.value.length>0?(n(),r("div",Fe,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select Pricing Tiers:",-1)),t("div",Le,[(n(!0),r(u,null,c(_.value,o=>(n(),r("label",{key:o.id,class:"flex items-center space-x-2"},[a(t("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":e[11]||(e[11]=b=>h.value=b),class:"rounded"},null,8,$e),[[K,h.value]]),t("span",Ue,i(o.duration_from)+" "+i(o.duration_unit)+" - ₱"+i(o.price),1)]))),128))])])):p.value?(n(),r("div",Ne," Loading pricing tiers... ")):(n(),r("div",qe," No pricing tiers available. ")),t("p",Pe,[e[37]||(e[37]=k(" You can set up pricing tiers in the ")),f(v(W),{href:"/owner/pricing-tiers",class:"text-blue-600 underline"},{default:V(()=>e[36]||(e[36]=[k("pricing management")])),_:1,__:[36]}),e[38]||(e[38]=k(" section. "))])]),t("div",Ee,[t("button",{type:"submit",disabled:x.value,class:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium py-3 px-6 rounded-md transition-colors"},i(x.value?"Creating Vehicle...":"Create Vehicle"),9,Ae)])],32)])]),_:1}))}};export{Oe as default};
