import{_ as xe,r as P,c as v,C as fe,a as he,o as l,w as X,b as e,f as a,i as c,e as f,t as s,n as p,d as ye,F as A,h as B,g as D,k as ke,v as Z,l as pe,Q as m}from"./app-D5PUyAMe.js";import{_ as we}from"./AuthenticatedLayout-B-cZbXuZ.js";import"./Footer-DI0umZVU.js";import"./Header-DdPT2WJT.js";import"./ResponsiveNavLink-BCB-x7oE.js";const _e={class:"py-12"},Oe={class:"max-w-6xl mx-auto sm:px-6 lg:px-8"},Ce={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Pe={class:"p-6 text-gray-900"},Me={class:"mb-6"},Re={class:"text-3xl font-bold text-gray-800"},Te={class:"flex items-center space-x-4 mt-2"},je={class:"text-sm text-gray-500"},$e={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Ae={class:"lg:col-span-2 space-y-6"},Be={class:"bg-gray-50 rounded-lg p-6"},De={class:"flex items-start space-x-4"},Fe={class:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-xl font-semibold"},Se={class:"flex-1"},Ne={class:"text-lg font-semibold"},Ve={class:"space-y-1 text-sm text-gray-600"},Le=["href"],Ue={key:0},Ie=["href"],He={class:"bg-gray-50 rounded-lg p-6"},Ee={class:"flex space-x-4"},ze=["src","alt"],qe={class:"flex-1"},Ge={class:"text-lg font-semibold"},Ye={class:"text-gray-600 mb-3"},Qe={class:"grid grid-cols-2 gap-4 text-sm text-gray-600"},We={class:"w-5xl h-56 bg-gray-200 rounded-lg overflow-hidden"},Je=["src"],Ke={key:1,class:"flex items-center justify-center h-full text-gray-500"},Xe={class:"bg-gray-50 rounded-lg p-6"},Ze={class:"grid grid-cols-2 gap-6"},et={class:"font-semibold"},tt={class:"text-xl font-bold text-green-600"},ot={class:"font-semibold"},st={class:"font-semibold"},nt={class:"mt-6 pt-4 border-t border-gray-200"},it={class:"bg-white rounded-lg p-4"},lt={class:"space-y-3"},rt={class:"flex justify-between items-start"},at={class:"font-medium text-red-700"},dt={class:"text-sm text-gray-600"},ut={class:"text-xs text-gray-500 mt-1"},ct={class:"text-right"},gt={class:"font-bold text-red-600"},mt={class:"mt-4 bg-gray-100 rounded-lg p-4"},bt={class:"grid grid-cols-2 gap-4 text-sm"},vt={class:"flex justify-between"},xt={class:"font-semibold"},ft={class:"flex justify-between"},ht={class:"font-semibold text-red-600"},yt={class:"flex justify-between"},kt={class:"text-green-600"},pt={class:"flex justify-between"},wt={class:"text-orange-600"},_t={class:"border-t mt-3 pt-3"},Ot={class:"flex justify-between font-bold text-lg"},Ct={key:0,class:"mt-6 pt-6 border-t"},Pt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Mt={class:"bg-white rounded-lg p-3 border"},Rt={class:"bg-white rounded-lg p-3 border"},Tt={class:"font-semibold"},jt={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},$t={class:"space-y-3"},At={class:"flex justify-between items-start"},Bt={class:"font-medium text-yellow-800"},Dt={class:"text-sm text-gray-600"},Ft={class:"text-xs text-gray-500 mt-1"},St={class:"text-right"},Nt={class:"font-bold text-yellow-700"},Vt={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Lt={class:"flex items-start"},Ut={class:"flex-1"},It={class:"text-sm text-red-600 mt-1"},Ht={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Et={key:1,class:"mt-6 pt-6 border-t"},zt={key:2,class:"mt-6 pt-6 border-t"},qt={class:"bg-green-50 border border-green-200 rounded-lg p-4"},Gt={class:"flex items-center"},Yt={class:"text-sm text-green-600"},Qt={class:"mt-3 pt-3 border-t border-green-200 text-xs text-gray-500"},Wt={class:"mt-3 pt-3 border-t border-green-200"},Jt=["disabled"],Kt={class:"mt-3 pt-3 border-t border-green-200"},Xt={key:0,class:"mt-3 p-3 bg-red-50 border border-red-200 rounded"},Zt={class:"space-y-3"},eo={class:"flex space-x-2"},to=["disabled"],oo={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-6"},so={class:"bg-white rounded-lg p-4 mb-4"},no={class:"space-y-2 text-sm"},io={class:"flex justify-between"},lo={class:"flex justify-between"},ro={class:"flex justify-between font-semibold text-green-600 border-t pt-2"},ao={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},uo={class:"space-y-3"},co={class:"flex justify-between items-start"},go={class:"font-medium text-red-700"},mo={class:"text-sm text-gray-600"},bo={class:"text-xs text-gray-500 mt-1"},vo={class:"text-right"},xo={class:"font-semibold text-red-600"},fo={class:"border-t pt-3"},ho={class:"flex justify-between font-semibold text-red-600"},yo={class:"flex justify-between text-sm text-gray-600"},ko={class:"text-green-600"},po={class:"flex justify-between text-sm text-gray-600"},wo={class:"text-orange-600"},_o={class:"bg-gray-800 text-white rounded-lg p-4"},Oo={class:"flex justify-between items-center"},Co={class:"text-right"},Po={class:"text-2xl font-bold"},Mo={class:"text-sm text-gray-300"},Ro={key:0,class:"mt-4 pt-4 border-t border-gray-600"},To={class:"space-y-2"},jo=["disabled"],$o={class:"lg:col-span-1"},Ao={class:"bg-white border rounded-lg p-6 sticky top-6"},Bo={class:"mb-6"},Do={class:"mt-1"},Fo={class:"mt-2 text-sm text-gray-600"},So={key:0,class:"mt-3 pt-2 border-t"},No={class:"mt-1"},Vo={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Lo={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800"},Uo={class:"mt-1 text-xs text-gray-500"},Io={class:"space-y-3"},Ho={key:0,class:"space-y-3"},Eo=["disabled"],zo=["disabled"],qo=["disabled"],Go=["disabled"],Yo={key:2,class:"p-3 bg-green-50 border border-green-200 rounded"},Qo={key:3,class:"p-3 bg-red-50 border border-red-200 rounded"},Wo={key:1,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6"},Jo={class:"flex items-start space-x-4"},Ko=["src"],Xo={class:"flex-1"},Zo={key:0,class:"text-sm text-yellow-700"},es={class:"font-mono"},ts={class:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-auto"},os={class:"p-4 text-center"},ss=["src"],ns={__name:"Show",props:{booking:Object,expectedReturnTime:String,potentialOvercharges:Array,recentOvercharges:Array,stats:Object},setup(o){const r=o,d=P(!1),M=P(!1),h=P(!1),g=P({type:"1",amount:"",details:""}),w=v(()=>{const n=new Date(r.booking.pickup_datetime),t=r.booking.pricing_tier;let u=new Date(n);switch(t.duration_unit){case"minutes":u.setMinutes(u.getMinutes()+t.duration_from);break;case"hours":u.setHours(u.getHours()+t.duration_from);break;case"days":u.setDate(u.getDate()+t.duration_from);break}return u.toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}),_=v(()=>{const n=new Date,u=new Date(r.expectedReturnTime||w.value).getTime()-n.getTime(),b=Math.floor(u/(1e3*60*60)),x=Math.floor(u%(1e3*60*60)/(1e3*60));if(u<=0){const y=Math.floor(Math.abs(u)/36e5),k=Math.floor(Math.abs(u)%(1e3*60*60)/(1e3*60));return{isOverdue:!0,text:y>0?`${y}h ${k}m overdue`:`${k}m overdue`}}return{isOverdue:!1,text:b>0?`${b}h ${x}m remaining`:`${x}m remaining`}});function ee(n){return{pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[n]||"bg-gray-100 text-gray-800"}function te(n){return n?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}function oe(n){return{pending:"Pending",confirmed:"Confirmed",completed:"Completed",cancelled:"Cancelled"}[n]||n}function O(n){return new Date(n).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function se(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function C(n){return n==null||isNaN(n)?"0.00":parseFloat(n).toFixed(2)}function F(n){if(!n||n<=0)return"0 minutes";if(n<1){const t=Math.round(n*60);return t===1?"1 minute":`${t} minutes`}else{const t=Math.floor(n),u=Math.round((n-t)*60),b=t===1?"1 hour":`${t} hours`;if(u>0){const x=u===1?"1 minute":`${u} minutes`;return`${b} ${x}`}else return b}}function R(n){return n.replace(/Late return by ([\d.]+) hours/g,(t,u)=>{const b=parseFloat(u);return`Late return by ${F(b)}`})}function ne(){M.value=!0}function S(){M.value=!1}function ie(){m.visit(route("owner.bookings.index"))}function le(){m.visit(route("vehicles.show",r.booking.vehicle.id))}function re(){d.value=!0,m.post(route("owner.bookings.confirmPayment",r.booking.id),{},{onFinish:()=>{d.value=!1}})}function ae(){d.value=!0,m.post(route("owner.bookings.confirm",r.booking.id),{},{onFinish:()=>{d.value=!1}})}function de(){confirm("Are you sure you want to reject this booking? This action cannot be undone.")&&(d.value=!0,m.post(route("owner.bookings.reject",r.booking.id),{},{onFinish:()=>{d.value=!1}}))}function ue(){confirm("Are you sure you want to mark this booking as completed? This will calculate any applicable overcharges.")&&(d.value=!0,m.post(route("owner.bookings.complete",r.booking.id),{},{onFinish:()=>{d.value=!1},onSuccess:()=>{m.reload()}}))}const N=v(()=>!r.booking.overcharges||r.booking.overcharges.length===0?!0:r.booking.overcharges.every(n=>n.is_paid)),V=v(()=>r.booking.overcharges?r.booking.overcharges.filter(n=>!n.is_paid):[]);function ce(n){confirm("Mark this overcharge as paid?")&&(d.value=!0,m.post(route("owner.overcharges.markAsPaid",n),{},{onFinish:()=>{d.value=!1},onSuccess:()=>{m.reload({only:["booking"]})}}))}const T=v(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.reduce((n,t)=>n+parseFloat(t.amount||0),0)),L=v(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.filter(n=>n.is_paid).reduce((n,t)=>n+parseFloat(t.amount||0),0)),j=v(()=>!r.booking.overcharges||r.booking.overcharges.length===0?0:r.booking.overcharges.filter(n=>!n.is_paid).reduce((n,t)=>n+parseFloat(t.amount||0),0)),U=v(()=>{const n=parseFloat(r.booking.total_amount||0),t=T.value;return n+t}),ge=v(()=>r.booking.overcharges&&r.booking.overcharges.length>0);function $(n){return{1:"‚è∞ Late Return",2:"üèôÔ∏è Out of City Use"}[n]||"Unknown Overcharge"}function me(){m.reload({only:["booking","expectedReturnTime","potentialOvercharges"]})}function be(){confirm("This will recalculate overcharges for this completed booking. Continue?")&&(d.value=!0,m.post(route("overcharges.calculate",r.booking.id),{},{onFinish:()=>{d.value=!1},onSuccess:()=>{m.reload()}}))}function ve(){if(!g.value.amount||parseFloat(g.value.amount)<=0){alert("Please enter a valid amount");return}if(confirm(`Add ‚Ç±${g.value.amount} overcharge to this booking?`)){d.value=!0;const n={overcharge_type_id:parseInt(g.value.type),amount:parseFloat(g.value.amount),details:g.value.details||"Manual overcharge added by owner",units:1,rate_applied:parseFloat(g.value.amount),is_paid:!1,occurred_at:new Date().toISOString()};m.post(route("owner.overcharges.add",r.booking.id),n,{onFinish:()=>{d.value=!1},onSuccess:()=>{g.value={type:"1",amount:"",details:""},h.value=!1,m.reload()}})}}function I(){const n=r.booking.user.phone,t=r.booking.user.email;if(n)window.open(`tel:${n}`,"_self");else if(t){const u=encodeURIComponent(`Regarding Your Booking #${r.booking.id} - Overcharge Notice`),b=encodeURIComponent(`Hello ${r.booking.user.first_name},

This is regarding your current vehicle rental booking (#${r.booking.id}).

We've detected some potential overcharges that may apply to your rental. Please contact us to discuss.

Best regards,
Your Vehicle Owner`);window.open(`mailto:${t}?subject=${u}&body=${b}`,"_self")}else alert("No contact information available for this renter.")}return(n,t)=>{const u=fe("MapPin");return l(),he(we,null,{header:X(()=>t[6]||(t[6]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Booking Management ",-1)])),default:X(()=>{var b,x,y,k,H,E,z,q,G,Y,Q,W,J,K;return[e("div",_e,[e("div",Oe,[e("div",Ce,[e("div",Pe,[e("div",{class:"mb-6"},[e("button",{onClick:ie,class:"inline-flex items-center text-blue-600 hover:text-blue-800 font-semibold transition-colors"},t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),f(" Back to Booking Requests ")]))]),e("div",Me,[e("h1",Re," Booking #"+s(o.booking.id),1),e("div",Te,[e("span",{class:p([ee(o.booking.status),"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"])},s(oe(o.booking.status)),3),e("span",je," Requested "+s(se(o.booking.created_at)),1)])]),e("div",$e,[e("div",Ae,[e("div",Be,[t[10]||(t[10]=e("h2",{class:"text-xl font-semibold mb-4"}," Customer Information ",-1)),e("div",De,[e("div",Fe,s(o.booking.user.first_name.charAt(0))+s(o.booking.user.last_name.charAt(0)),1),e("div",Se,[e("h3",Ne,s(o.booking.user.first_name)+" "+s(o.booking.user.last_name),1),e("div",Ve,[e("div",null,[t[8]||(t[8]=e("span",{class:"font-medium"},"Email:",-1)),e("a",{href:`mailto:${o.booking.user.email}`,class:"text-blue-600 hover:text-blue-800"},s(o.booking.user.email),9,Le)]),o.booking.user.phone?(l(),a("div",Ue,[t[9]||(t[9]=e("span",{class:"font-medium"},"Phone:",-1)),e("a",{href:`tel:${o.booking.user.phone}`,class:"text-blue-600 hover:text-blue-800"},s(o.booking.user.phone),9,Ie)])):c("",!0)])])])]),e("div",He,[t[16]||(t[16]=e("h2",{class:"text-xl font-semibold mb-4"}," Vehicle Information ",-1)),e("div",Ee,[e("img",{src:o.booking.vehicle.main_photo_url||"/images/placeholder-vehicle.jpg",alt:`${(b=o.booking.vehicle.brand)==null?void 0:b.name} ${(x=o.booking.vehicle.type)==null?void 0:x.sub_type}`,class:"w-32 h-32 object-cover rounded-lg"},null,8,ze),e("div",qe,[e("h3",Ge,s((y=o.booking.vehicle.brand)==null?void 0:y.name)+" "+s((k=o.booking.vehicle.type)==null?void 0:k.sub_type),1),e("p",Ye,s(o.booking.vehicle.license_plate),1),e("div",Qe,[e("div",null,[t[11]||(t[11]=e("span",{class:"font-medium"},"Year:",-1)),f(" "+s(o.booking.vehicle.year),1)]),e("div",null,[t[12]||(t[12]=e("span",{class:"font-medium"},"Color:",-1)),f(" "+s(o.booking.vehicle.color),1)]),e("div",null,[t[13]||(t[13]=e("span",{class:"font-medium"},"Fuel:",-1)),f(" "+s((H=o.booking.vehicle.fuel_type)==null?void 0:H.name),1)]),e("div",null,[t[14]||(t[14]=e("span",{class:"font-medium"},"Location:",-1)),f(" "+s(o.booking.vehicle.location_name),1)])])])]),t[17]||(t[17]=e("h2",{class:"text-xl font-semibold mb-4"}," Location Map ",-1)),e("div",We,[o.booking.vehicle.lat&&o.booking.vehicle.lng?(l(),a("iframe",{key:0,src:`https://maps.google.com/maps?q=${o.booking.vehicle.lat},${o.booking.vehicle.lng}&z=18&t=k&output=embed`,class:"w-full h-full border-0",loading:"lazy",allowfullscreen:""},null,8,Je)):(l(),a("div",Ke,[ye(u,{class:"h-8 w-8 mr-2"}),t[15]||(t[15]=e("span",null,"Location not available",-1))]))])]),e("div",Xe,[t[28]||(t[28]=e("h2",{class:"text-xl font-semibold mb-4"}," Booking Details ",-1)),e("div",Ze,[e("div",null,[t[18]||(t[18]=e("span",{class:"text-sm text-gray-500"},"Duration",-1)),e("div",et,s(o.booking.pricing_tier.duration_from)+" "+s(o.booking.pricing_tier.duration_from===1?o.booking.pricing_tier.duration_unit.slice(0,-1):o.booking.pricing_tier.duration_unit),1)]),e("div",null,[t[19]||(t[19]=e("span",{class:"text-sm text-gray-500"},"Base Rental Fee",-1)),e("div",tt," ‚Ç±"+s(C(o.booking.total_amount)),1)]),e("div",null,[t[20]||(t[20]=e("span",{class:"text-sm text-gray-500"},"Pickup Date & Time",-1)),e("div",ot,s(O(o.booking.pickup_datetime)),1)]),e("div",null,[t[21]||(t[21]=e("span",{class:"text-sm text-gray-500"},"Estimated Return",-1)),e("div",st,s(w.value),1)])]),e("div",nt,[e("div",it,[t[27]||(t[27]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"}," üí∞ Applied Overcharges ",-1)),e("div",lt,[(l(!0),a(A,null,B(o.booking.overcharges,i=>(l(),a("div",{key:i.id,class:"bg-red-50 border border-red-200 rounded-lg p-4"},[e("div",rt,[e("div",null,[e("div",at,s($(i.overcharge_type_id)),1),e("div",dt,s(R(i.details)),1),e("div",ut," Applied on "+s(O(i.occurred_at)),1)]),e("div",ct,[e("div",gt,"‚Ç±"+s(i.amount),1),e("div",{class:p([i.is_paid?"text-green-600":"text-orange-600","text-xs font-medium"])},s(i.is_paid?"‚úÖ PAID":"‚è≥ PENDING"),3)])])]))),128))]),e("div",mt,[e("div",bt,[e("div",vt,[t[22]||(t[22]=e("span",null,"Base Rental:",-1)),e("span",xt,"‚Ç±"+s(o.booking.total_amount),1)]),e("div",ft,[t[23]||(t[23]=e("span",null,"Total Overcharges:",-1)),e("span",ht,"‚Ç±"+s(T.value),1)]),e("div",yt,[t[24]||(t[24]=e("span",null,"Paid Overcharges:",-1)),e("span",kt,"‚Ç±"+s(L.value),1)]),e("div",pt,[t[25]||(t[25]=e("span",null,"Pending Collection:",-1)),e("span",wt,"‚Ç±"+s(j.value),1)])]),e("div",_t,[e("div",Ot,[t[26]||(t[26]=e("span",null,"Grand Total:",-1)),e("span",null,"‚Ç±"+s(U.value),1)])])])])])]),o.booking.status==="confirmed"?(l(),a("div",Ct,[e("div",{class:"flex items-center justify-between mb-4"},[t[29]||(t[29]=e("h3",{class:"text-lg font-semibold text-gray-800"}," ‚ö†Ô∏è Live Overcharge Monitoring ",-1)),e("button",{onClick:me,class:"text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors"}," üîÑ Refresh Status ")]),e("div",Pt,[e("div",Mt,[t[30]||(t[30]=e("div",{class:"text-sm text-gray-500"},"Current Status",-1)),e("div",{class:p(_.value.isOverdue?"text-red-600 font-bold":"text-green-600 font-semibold")},s(_.value.text),3)]),e("div",Rt,[t[31]||(t[31]=e("div",{class:"text-sm text-gray-500"},"Expected Return",-1)),e("div",Tt,s(O(o.expectedReturnTime||w.value)),1)])]),o.potentialOvercharges&&o.potentialOvercharges.length>0?(l(),a("div",jt,[t[33]||(t[33]=e("h4",{class:"font-semibold text-yellow-800 mb-3"}," üö® Active Overcharges Detected ",-1)),e("div",$t,[(l(!0),a(A,null,B(o.potentialOvercharges,i=>(l(),a("div",{key:i.overcharge_type_id,class:"bg-white rounded p-3 border-l-4 border-yellow-400"},[e("div",At,[e("div",null,[e("div",Bt,s($(i.overcharge_type_id)),1),e("div",Dt,s(R(i.details)),1),e("div",Ft,s(i.overcharge_type_id===1?F(i.units):`${i.units} km`)+" √ó ‚Ç±"+s(i.rate_applied)+" per "+s(i.overcharge_type_id===1?"hour":"km"),1)]),e("div",St,[e("div",Nt,"‚Ç±"+s(i.amount),1),t[32]||(t[32]=e("div",{class:"text-xs text-yellow-600"},"Will be applied at completion",-1))])])]))),128))]),e("div",{class:"mt-4 pt-3 border-t border-yellow-200"},[e("button",{onClick:I,class:"w-full bg-yellow-600 hover:bg-yellow-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"}," üìû Contact Renter About Overcharges ")])])):o.booking.status==="confirmed"&&_.value.isOverdue?(l(),a("div",Vt,[e("div",Lt,[t[36]||(t[36]=e("div",{class:"text-red-600 mr-3"},"‚ö†Ô∏è",-1)),e("div",Ut,[t[34]||(t[34]=e("div",{class:"font-semibold text-red-800"},"Vehicle is Overdue - Potential Overcharges",-1)),e("div",It," This rental is "+s(_.value.text)+". Overcharges may apply when the booking is completed. ",1),t[35]||(t[35]=e("div",{class:"text-xs text-red-500 mt-2"}," Automatic overcharge calculation will occur when the booking is marked as completed. Contact the renter to discuss return or extension options. ",-1))])]),e("div",{class:"mt-4 pt-3 border-t border-red-200"},[e("button",{onClick:I,class:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"}," üìû Contact Renter - Vehicle Overdue ")])])):o.booking.status==="confirmed"?(l(),a("div",Ht,t[37]||(t[37]=[e("div",{class:"flex items-center"},[e("div",{class:"text-green-600 mr-3"},"‚úÖ"),e("div",null,[e("div",{class:"font-semibold text-green-800"},"No Overcharges Detected"),e("div",{class:"text-sm text-green-600"},"Rental is proceeding normally within guidelines")])],-1)]))):c("",!0)])):c("",!0),o.booking.status==="completed"&&o.booking.overcharges&&o.booking.overcharges.length>0?(l(),a("div",Et)):c("",!0),o.booking.status==="completed"&&(!o.booking.overcharges||o.booking.overcharges.length===0)?(l(),a("div",zt,[e("div",qt,[e("div",Gt,[t[39]||(t[39]=e("div",{class:"text-green-600 mr-3"},"‚úÖ",-1)),e("div",null,[t[38]||(t[38]=e("div",{class:"font-semibold text-green-800"},"Clean Rental - No Overcharges",-1)),e("div",Yt," Rental completed without any violations. Total earned: ‚Ç±"+s(C(o.booking.total_amount)),1)])]),e("div",Qt,[e("div",null,"Expected Return: "+s(o.expectedReturnTime||w.value),1),e("div",null,"Actual Return: "+s(o.booking.return_time?O(o.booking.return_time):"Not set"),1),e("div",null,"Overcharges Array: "+s(o.booking.overcharges?o.booking.overcharges.length:"null")+" items",1),e("div",null,"Has Overcharges Flag: "+s(o.booking.has_overcharges?"true":"false"),1),e("div",null,"Total Overcharges Amount: ‚Ç±"+s(C(o.booking.total_overcharges||0)),1)]),e("div",Wt,[e("button",{onClick:be,disabled:d.value,class:"text-sm bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-400 text-white font-medium py-2 px-3 rounded transition-colors disabled:cursor-not-allowed"}," üîÑ Recalculate Overcharges ",8,Jt),t[40]||(t[40]=e("div",{class:"text-xs text-gray-500 mt-1"}," Click if this booking should have overcharges but doesn't show any ",-1))]),e("div",Kt,[e("button",{onClick:t[0]||(t[0]=i=>h.value=!h.value),class:"text-sm bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-3 rounded transition-colors"}," ‚ûï Add Manual Overcharge "),h.value?(l(),a("div",Xt,[e("div",Zt,[e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700"},"Type",-1)),D(e("select",{"onUpdate:modelValue":t[1]||(t[1]=i=>g.value.type=i),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},t[41]||(t[41]=[e("option",{value:"1"},"Late Return",-1),e("option",{value:"2"},"Out of City Use",-1)]),512),[[ke,g.value.type]])]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700"},"Amount (‚Ç±)",-1)),D(e("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>g.value.amount=i),type:"number",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[Z,g.value.amount]])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700"},"Description",-1)),D(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=i=>g.value.details=i),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm",rows:"2",placeholder:"Reason for this overcharge..."},null,512),[[Z,g.value.details]])]),e("div",eo,[e("button",{onClick:ve,disabled:d.value||!g.value.amount,class:"text-sm bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium py-1 px-2 rounded transition-colors disabled:cursor-not-allowed"}," Add Overcharge ",8,to),e("button",{onClick:t[4]||(t[4]=i=>h.value=!1),class:"text-sm bg-gray-600 hover:bg-gray-700 text-white font-medium py-1 px-2 rounded transition-colors"}," Cancel ")])])])):c("",!0)])])])):c("",!0)]),o.booking.status==="completed"?(l(),a("div",oo,[t[61]||(t[61]=e("h2",{class:"text-xl font-semibold mb-4 text-green-800"}," üí∞ Final Payment Breakdown ",-1)),e("div",so,[t[48]||(t[48]=e("h3",{class:"text-lg font-medium text-gray-800 mb-3 flex items-center"}," üéØ Base Rental Fee ",-1)),e("div",no,[e("div",io,[t[45]||(t[45]=e("span",null,"Duration:",-1)),e("span",null,s(o.booking.pricing_tier.duration_from)+" "+s(o.booking.pricing_tier.duration_unit),1)]),e("div",lo,[t[46]||(t[46]=e("span",null,"Rate:",-1)),e("span",null,"‚Ç±"+s(o.booking.pricing_tier.price),1)]),e("div",ro,[t[47]||(t[47]=e("span",null,"Base Total:",-1)),e("span",null,"‚Ç±"+s(o.booking.total_amount),1)])])]),o.booking.overcharges&&o.booking.overcharges.length>0?(l(),a("div",ao,[t[52]||(t[52]=e("h3",{class:"text-lg font-medium text-red-800 mb-3 flex items-center"}," ‚ö†Ô∏è Additional Overcharge Fees ",-1)),e("div",uo,[(l(!0),a(A,null,B(o.booking.overcharges,i=>(l(),a("div",{key:i.id,class:"bg-white rounded p-3"},[e("div",co,[e("div",null,[e("div",go,s($(i.overcharge_type_id)),1),e("div",mo,s(R(i.details)),1),e("div",bo,s(i.units)+" "+s(i.overcharge_type_id===1?"hours":"km")+" √ó ‚Ç±"+s(i.rate_applied),1)]),e("div",vo,[e("div",xo,"‚Ç±"+s(i.amount),1),e("div",{class:p([i.is_paid?"text-green-600":"text-orange-600","text-xs font-medium"])},s(i.is_paid?"‚úÖ PAID":"‚è≥ PENDING"),3)])])]))),128)),e("div",fo,[e("div",ho,[t[49]||(t[49]=e("span",null,"Total Overcharges:",-1)),e("span",null,"‚Ç±"+s(T.value),1)]),e("div",yo,[t[50]||(t[50]=e("span",null,"Paid:",-1)),e("span",ko,"‚Ç±"+s(L.value),1)]),e("div",po,[t[51]||(t[51]=e("span",null,"Pending:",-1)),e("span",wo,"‚Ç±"+s(j.value),1)])])])])):c("",!0),e("div",_o,[e("div",Oo,[t[53]||(t[53]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"Total Amount Due"),e("p",{class:"text-sm text-gray-300"},"Base rental + overcharges")],-1)),e("div",Co,[e("div",Po,"‚Ç±"+s(U.value),1),e("div",Mo,s(N.value?"‚úÖ Fully Paid":"‚è≥ Partial Payment"),1)])]),V.value.length>0?(l(),a("div",Ro,[t[54]||(t[54]=e("h4",{class:"text-sm font-medium mb-2"},"Overcharge Collection Actions:",-1)),e("div",To,[n.overcharge.is_paid?c("",!0):(l(),a("button",{key:0,onClick:t[5]||(t[5]=i=>ce(n.overcharge.id)),disabled:d.value,class:"text-xs bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-medium py-1 px-2 rounded transition-colors disabled:cursor-not-allowed"}," Mark as Paid ",8,jo))])])):c("",!0)]),e("div",$o,[e("div",Ao,[t[60]||(t[60]=e("h2",{class:"text-xl font-semibold mb-4"}," Actions ",-1)),e("div",Bo,[t[57]||(t[57]=e("span",{class:"text-sm text-gray-500"},"Payment Status",-1)),e("div",Do,[e("span",{class:p([te((E=o.booking.payment)==null?void 0:E.paid_at),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},s((z=o.booking.payment)!=null&&z.paid_at?"Payment Confirmed":"Payment Pending"),3)]),e("div",Fo,[t[55]||(t[55]=e("span",{class:"font-medium"},"Method:",-1)),f(" "+s(((G=(q=o.booking.payment)==null?void 0:q.payment_mode)==null?void 0:G.name)||"N/A"),1)]),o.booking.status==="completed"&&ge.value?(l(),a("div",So,[t[56]||(t[56]=e("span",{class:"text-sm text-gray-500"},"Overcharge Status",-1)),e("div",No,[N.value?(l(),a("span",Vo," ‚úÖ All Overcharges Paid ")):(l(),a("span",Lo," ‚è≥ "+s(V.value.length)+" Pending Payment(s) ",1))]),e("div",Uo," Outstanding: ‚Ç±"+s(C(j.value)),1)])):c("",!0)]),e("div",Io,[o.booking.status==="pending"?(l(),a("div",Ho,[(Y=o.booking.payment)!=null&&Y.receipt_image&&!o.booking.payment.paid_at?(l(),a("button",{key:0,onClick:re,disabled:d.value,class:"w-full py-2 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(d.value?"Processing...":"Confirm Payment & Booking"),9,Eo)):c("",!0),((Q=o.booking.payment)==null?void 0:Q.type)==="cod"||(W=o.booking.payment)!=null&&W.paid_at?(l(),a("button",{key:1,onClick:ae,disabled:d.value,class:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(d.value?"Processing...":"Confirm Booking"),9,zo)):c("",!0),e("button",{onClick:de,disabled:d.value,class:"w-full py-2 px-4 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(d.value?"Processing...":"Reject Booking"),9,qo)])):c("",!0),o.booking.status==="confirmed"?(l(),a("button",{key:1,onClick:ue,disabled:d.value,class:"w-full py-2 px-4 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-colors disabled:cursor-not-allowed"},s(d.value?"Processing...":"Mark as Completed"),9,Go)):c("",!0),o.booking.status==="completed"?(l(),a("div",Yo,t[58]||(t[58]=[e("div",{class:"text-green-800 font-medium text-sm"}," Booking Completed ",-1),e("div",{class:"text-green-600 text-xs mt-1"}," This booking has been marked as completed. ",-1)]))):c("",!0),o.booking.status==="cancelled"?(l(),a("div",Qo,t[59]||(t[59]=[e("div",{class:"text-red-800 font-medium text-sm"}," Booking Cancelled ",-1),e("div",{class:"text-red-600 text-xs mt-1"}," This booking has been cancelled. ",-1)]))):c("",!0)]),e("div",{class:"border-t pt-4 mt-6"},[e("button",{onClick:le,class:"w-full py-2 px-4 border border-gray-300 text-gray-700 hover:bg-gray-50 font-semibold rounded-lg transition-colors"}," View Vehicle ")])])])])):c("",!0),(J=o.booking.payment)!=null&&J.receipt_image?(l(),a("div",Wo,[t[64]||(t[64]=e("h2",{class:"text-xl font-semibold mb-4 text-yellow-800"}," Payment Proof Submitted ",-1)),e("div",Jo,[e("img",{src:o.booking.payment.receipt_image,alt:"Payment Receipt",class:"w-48 h-48 object-cover rounded border cursor-pointer",onClick:ne},null,8,Ko),e("div",Xo,[t[63]||(t[63]=e("p",{class:"text-yellow-800 mb-3"}," Customer has uploaded payment proof. Please verify the payment before confirming the booking. ",-1)),o.booking.payment.reference_number?(l(),a("div",Zo,[t[62]||(t[62]=e("span",{class:"font-medium"},"Reference Number:",-1)),e("span",es,s(o.booking.payment.reference_number),1)])):c("",!0)])])])):c("",!0)])])])])]),M.value?(l(),a("div",{key:0,onClick:pe(S,["self"]),class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},[e("div",ts,[e("div",{class:"p-4 border-b flex justify-between items-center"},[t[66]||(t[66]=e("h3",{class:"text-lg font-semibold"},"Payment Receipt",-1)),e("button",{onClick:S,class:"text-gray-400 hover:text-gray-600"},t[65]||(t[65]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",os,[e("img",{src:(K=o.booking.payment)==null?void 0:K.receipt_image,alt:"Payment Receipt",class:"max-w-full h-auto mx-auto rounded border"},null,8,ss)])])])):c("",!0)]}),_:1})}}},us=xe(ns,[["__scopeId","data-v-9cc0e0c6"]]);export{us as default};
